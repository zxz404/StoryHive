/*! For license information please see 454.bundle.js.LICENSE.txt */
"use strict";(self.webpackChunkapp_starter_project_with_webpack=self.webpackChunkapp_starter_project_with_webpack||[]).push([[454],{454:(t,e,n)=>{n.r(e),n.d(e,{default:()=>w});var r=n(330),a=n(805);function i(t){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(t)}function o(){var t=v(),e=t.m(o),n=(Object.getPrototypeOf?Object.getPrototypeOf(e):e.__proto__).constructor;function r(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===n||"GeneratorFunction"===(e.displayName||e.name))}var a={throw:1,return:2,break:3,continue:3};function i(t){var e,n;return function(r){e||(e={stop:function(){return n(r.a,2)},catch:function(){return r.v},abrupt:function(t,e){return n(r.a,a[t],e)},delegateYield:function(t,a,i){return e.resultName=a,n(r.d,s(t),i)},finish:function(t){return n(r.f,t)}},n=function(t,n,a){r.p=e.prev,r.n=e.next;try{return t(n,a)}finally{e.next=r.n}}),e.resultName&&(e[e.resultName]=r.v,e.resultName=void 0),e.sent=r.v,e.next=r.n;try{return t.call(this,e)}finally{r.p=e.prev,r.n=e.next}}}return(o=function(){return{wrap:function(e,n,r,a){return t.w(i(e),n,r,a&&a.reverse())},isGeneratorFunction:r,mark:t.m,awrap:function(t,e){return new p(t,e)},AsyncIterator:f,async:function(t,e,n,a,o){return(r(e)?l:u)(i(t),e,n,a,o)},keys:c,values:s}})()}function s(t){if(null!=t){var e=t["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],n=0;if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length))return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}}throw new TypeError(i(t)+" is not iterable")}function c(t){var e=Object(t),n=[];for(var r in e)n.unshift(r);return function t(){for(;n.length;)if((r=n.pop())in e)return t.value=r,t.done=!1,t;return t.done=!0,t}}function u(t,e,n,r,a){var i=l(t,e,n,r,a);return i.next().then((function(t){return t.done?t.value:i.next()}))}function l(t,e,n,r,a){return new f(v().w(t,e,n,r),a||Promise)}function f(t,e){function n(r,a,i,o){try{var s=t[r](a),c=s.value;return c instanceof p?e.resolve(c.v).then((function(t){n("next",t,i,o)}),(function(t){n("throw",t,i,o)})):e.resolve(c).then((function(t){s.value=t,i(s)}),(function(t){return n("throw",t,i,o)}))}catch(t){o(t)}}var r;this.next||(d(f.prototype),d(f.prototype,"function"==typeof Symbol&&Symbol.asyncIterator||"@asyncIterator",(function(){return this}))),d(this,"_invoke",(function(t,a,i){function o(){return new e((function(e,r){n(t,i,e,r)}))}return r=r?r.then(o,o):o()}),!0)}function v(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",a=n.toStringTag||"@@toStringTag";function i(n,r,a,i){var c=r&&r.prototype instanceof s?r:s,u=Object.create(c.prototype);return d(u,"_invoke",function(n,r,a){var i,s,c,u=0,l=a||[],f=!1,v={p:0,n:0,v:t,a:d,f:d.bind(t,4),d:function(e,n){return i=e,s=0,c=t,v.n=n,o}};function d(n,r){for(s=n,c=r,e=0;!f&&u&&!a&&e<l.length;e++){var a,i=l[e],d=v.p,p=i[2];n>3?(a=p===r)&&(c=i[(s=i[4])?5:(s=3,3)],i[4]=i[5]=t):i[0]<=d&&((a=n<2&&d<i[1])?(s=0,v.v=r,v.n=i[1]):d<p&&(a=n<3||i[0]>r||r>p)&&(i[4]=n,i[5]=r,v.n=p,s=0))}if(a||n>1)return o;throw f=!0,r}return function(a,l,p){if(u>1)throw TypeError("Generator is already running");for(f&&1===l&&d(l,p),s=l,c=p;(e=s<2?t:c)||!f;){i||(s?s<3?(s>1&&(v.n=-1),d(s,c)):v.n=c:v.v=c);try{if(u=2,i){if(s||(a="next"),e=i[a]){if(!(e=e.call(i,c)))throw TypeError("iterator result is not an object");if(!e.done)return e;c=e.value,s<2&&(s=0)}else 1===s&&(e=i.return)&&e.call(i),s<2&&(c=TypeError("The iterator does not provide a '"+a+"' method"),s=1);i=t}else if((e=(f=v.n<0)?c:n.call(r,v))!==o)break}catch(e){i=t,s=1,c=e}finally{u=1}}return{value:e,done:f}}}(n,a,i),!0),u}var o={};function s(){}function c(){}function u(){}e=Object.getPrototypeOf;var l=[][r]?e(e([][r]())):(d(e={},r,(function(){return this})),e),f=u.prototype=s.prototype=Object.create(l);function p(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,u):(t.__proto__=u,d(t,a,"GeneratorFunction")),t.prototype=Object.create(f),t}return c.prototype=u,d(f,"constructor",u),d(u,"constructor",c),c.displayName="GeneratorFunction",d(u,a,"GeneratorFunction"),d(f),d(f,a,"Generator"),d(f,r,(function(){return this})),d(f,"toString",(function(){return"[object Generator]"})),(v=function(){return{w:i,m:p}})()}function d(t,e,n,r){var a=Object.defineProperty;try{a({},"",{})}catch(t){a=0}d=function(t,e,n,r){function i(e,n){d(t,e,(function(t){return this._invoke(e,n,t)}))}e?a?a(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n:(i("next",0),i("throw",1),i("return",2))},d(t,e,n,r)}function p(t,e){this.v=t,this.k=e}function h(t,e,n,r,a,i,o){try{var s=t[i](o),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(r,a)}function y(t){return function(){var e=this,n=arguments;return new Promise((function(r,a){var i=t.apply(e,n);function o(t){h(i,r,a,o,s,"next",t)}function s(t){h(i,r,a,o,s,"throw",t)}o(void 0)}))}}function m(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,b(r.key),r)}}function b(t){var e=function(t){if("object"!=i(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=i(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==i(e)?e:e+""}const w=function(){return t=function t(){var e,n,r,a=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),e=this,n="debLoadFav",r=this.debounce((function(){return a.loadFav()}),300),(n=b(n))in e?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r,this.element=null,this.items=[],this.filtItems=[],this.curFilt={srch:"",sort:"createdAt",order:"desc",owner:""},this.uniqOwners=[]},e=[{key:"createView",value:function(){var t=this,e=document.createElement("section");return e.className="pg fav-pg",e.innerHTML='\n            <div class="fav-page">\n                <div class="page-hdr">\n                    <h1>üíñ Cerita Favorit</h1>\n                    <p class="page-subtitle">Kelola cerita yang Anda tandai sebagai favorit</p>\n                </div>\n\n                <div class="sync-sts" id="syncSts"></div>\n\n                <section class="search-section" aria-labelledby="search-title">\n                    <h2 id="search-title" class="visually-hidden">Pencarian dan Filter</h2>\n                    <div class="fav-ctrl">\n                        <div class="srch-box">\n                            <label for="srchFav" class="srch-label visually-hidden">\n                                Cari cerita favorit\n                            </label>\n                            <input \n                                type="text" \n                                id="srchFav" \n                                name="search"\n                                placeholder="Cari cerita favorit..." \n                                aria-label="Cari cerita favorit berdasarkan judul atau deskripsi"\n                                aria-describedby="search-help"\n                                value="'.concat(this.curFilt.srch,'"\n                            >\n                            <span class="srch-ico" aria-hidden="true">üîç</span>\n                            <span id="search-help" class="visually-hidden">\n                                Ketik untuk mencari cerita favorit berdasarkan judul atau deskripsi\n                            </span>\n                        </div>\n\n                        <div class="fltr-ctrl">\n                            <select id="sortBy" aria-label="Urutkan berdasarkan">\n                                <option value="createdAt" ').concat("createdAt"===this.curFilt.sort?"selected":"",'>By Tanggal</option>\n                                <option value="name" ').concat("name"===this.curFilt.sort?"selected":"",'>By Nama</option>\n                            </select>\n\n                            <select id="sortOrd" aria-label="Urutan sortir">\n                                <option value="desc" ').concat("desc"===this.curFilt.order?"selected":"",'>Terbaru</option>\n                                <option value="asc" ').concat("asc"===this.curFilt.order?"selected":"",'>Terlama</option>\n                            </select>\n\n                            <select id="fltrOwn" aria-label="Filter berdasarkan penulis">\n                                <option value="">All Penulis</option>\n                                ').concat(this.uniqOwners.map((function(e){return'<option value="'.concat(e,'" ').concat(t.curFilt.owner===e?"selected":"",">").concat(e,"</option>")})).join(""),'\n                            </select>\n                        </div>\n                    </div>\n                </section>\n\n                <section class="favorites-section" aria-labelledby="favorites-title">\n                    <h2 id="favorites-title" class="visually-hidden">Daftar Favorit</h2>\n                    <div class="fav-list" id="favList">\n                        <div class="loading">Memuat favorit...</div>\n                    </div>\n\n                    <div class="empty-st" id="emptySt" style="display: none;">\n                        <div class="empty-ico">üìö</div>\n                        <h3>Belum ada cerita favorit</h3>\n                        <p>Tambahkan cerita ke favorit untuk melihat di sini</p>\n                    </div>\n                </section>\n            </div>\n        '),this.element=e,e}},{key:"init",value:(u=y(o().mark((function t(){return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.element||this.createView(),t.next=3,this.afterRender();case 3:case"end":return t.stop()}}),t,this)}))),function(){return u.apply(this,arguments)})},{key:"afterRender",value:(c=y(o().mark((function t(){return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.loadFav();case 2:this.setupEvt(),this.setupSyncEvt();case 4:case"end":return t.stop()}}),t,this)}))),function(){return c.apply(this,arguments)})},{key:"loadFav",value:(s=y(o().mark((function t(){return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,r.U.getFav(this.curFilt);case 3:return this.items=t.sent,t.next=6,r.U.getUniqOwners();case 6:this.uniqOwners=t.sent,this.updateUI(),this.updateSyncSts(),t.next=15;break;case 11:t.prev=11,t.t0=t.catch(0),console.error("Error load fav:",t.t0),this.showErr("Gagal memuat favorit");case 15:case"end":return t.stop()}}),t,this,[[0,11]])}))),function(){return s.apply(this,arguments)})},{key:"updateUI",value:function(){if(this.element){var t=this.element.querySelector("#favList"),e=this.element.querySelector("#emptySt");if(t&&e){if(0===this.items.length)return t.innerHTML="",void(e.style.display="block");e.style.display="none",t.innerHTML=this.items.map((function(t){var e;return'\n            <article class="fav-item" data-id="'.concat(t.id,'">\n                <div class="item-img">\n                    <img src="').concat(t.photoUrl,'" \n                         alt="').concat(t.name||"Story",'" \n                         onerror="this.src=\'/images/Logo.png\'">\n                    ').concat(t.pendingSync?'<span class="sync-bdg">‚è≥ Offline</span>':"",'\n                </div>\n                \n                <div class="item-cont">\n                    <h3 class="item-title">').concat(t.name||"No Title",'</h3>\n                    <p class="item-desc">').concat(t.description||"No description",'</p>\n                    \n                    <div class="item-meta">\n                        <span class="item-own">üë§ ').concat((null===(e=t.owner)||void 0===e?void 0:e.name)||"Unknown",'</span>\n                        <span class="item-date">üìÖ ').concat(new Date(t.createdAt).toLocaleDateString("id-ID"),'</span>\n                    </div>\n                </div>\n                \n                <div class="item-act">\n                    <button class="btn-rmv" data-id="').concat(t.id,'" title="Hapus dari favorit" aria-label="Hapus dari favorit">\n                        ‚ùå\n                    </button>\n                </div>\n            </article>\n        ')})).join(""),this.updateOwnFltr()}}}},{key:"updateOwnFltr",value:function(){var t=this;if(this.element){var e=this.element.querySelector("#fltrOwn");e&&(e.innerHTML='\n            <option value="">All Penulis</option>\n            '.concat(this.uniqOwners.map((function(e){return'<option value="'.concat(e,'" ').concat(t.curFilt.owner===e?"selected":"",">").concat(e,"</option>")})).join(""),"\n        "))}}},{key:"updateSyncSts",value:(i=y(o().mark((function t(){var e,n;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.element){t.next=2;break}return t.abrupt("return");case 2:if(e=this.element.querySelector("#syncSts")){t.next=5;break}return t.abrupt("return");case 5:return t.next=7,a.J.getSyncSts();case 7:n=t.sent,e.innerHTML='\n            <div class="sync-sts-cont '.concat(n.isOnline?"on":"off",'">\n                <span class="sts-ind"></span>\n                <span class="sts-txt">\n                    ').concat(n.isOnline?"üü¢ Online":"üî¥ Offline"," | \n                    ").concat(n.pendingSyncCount," pending sync |\n                    ").concat(n.totalFav," favorit\n                </span>\n            </div>\n        ");case 9:case"end":return t.stop()}}),t,this)}))),function(){return i.apply(this,arguments)})},{key:"setupEvt",value:function(){var t=this;if(this.element){var e=this.element.querySelector("#srchFav");e&&e.addEventListener("input",(function(e){t.curFilt.srch=e.target.value,t.debLoadFav()}));var n=this.element.querySelector("#sortBy");n&&n.addEventListener("change",(function(e){t.curFilt.sort=e.target.value,t.loadFav()}));var r=this.element.querySelector("#sortOrd");r&&r.addEventListener("change",(function(e){t.curFilt.order=e.target.value,t.loadFav()}));var a=this.element.querySelector("#fltrOwn");a&&a.addEventListener("change",(function(e){t.curFilt.owner=e.target.value,t.loadFav()})),this.element.addEventListener("click",function(){var e=y(o().mark((function e(n){var r;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!n.target.classList.contains("btn-rmv")){e.next=4;break}return r=n.target.dataset.id,e.next=4,t.rmvFav(r);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}}},{key:"setupSyncEvt",value:function(){var t=this;window.addEventListener("storySynced",(function(e){t.showMsg("Berhasil sinkronisasi!","success"),t.loadFav()})),window.addEventListener("syncCompleted",(function(e){t.showMsg("Semua cerita offline berhasil disinkronisasi!","success"),t.loadFav()})),window.addEventListener("storySavedOffline",(function(e){t.showMsg("Disimpan offline, akan sinkron nanti","info")}))}},{key:"rmvFav",value:(n=y(o().mark((function t(e){return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("undefined"==typeof Swal){t.next=19;break}return t.next=3,Swal.fire({title:"Hapus dari Favorit?",text:"Cerita akan dihapus dari daftar favorit Anda",icon:"warning",showCancelButton:!0,confirmButtonColor:"#EF4444",cancelButtonColor:"#64748b",confirmButtonText:"Ya, Hapus",cancelButtonText:"Batal"});case 3:if(!t.sent.isConfirmed){t.next=17;break}return t.prev=5,t.next=8,r.U.rmvFav(e);case 8:return this.showMsg("Berhasil dihapus dari favorit","success"),t.next=11,this.loadFav();case 11:t.next=17;break;case 13:t.prev=13,t.t0=t.catch(5),console.error("Error remove fav:",t.t0),this.showMsg("Gagal menghapus dari favorit","error");case 17:t.next=32;break;case 19:if(!confirm("Hapus dari favorit?")){t.next=32;break}return t.prev=20,t.next=23,r.U.rmvFav(e);case 23:return this.showMsg("Berhasil dihapus dari favorit","success"),t.next=26,this.loadFav();case 26:t.next=32;break;case 28:t.prev=28,t.t1=t.catch(20),console.error("Error remove fav:",t.t1),this.showMsg("Gagal menghapus dari favorit","error");case 32:case"end":return t.stop()}}),t,this,[[5,13],[20,28]])}))),function(t){return n.apply(this,arguments)})},{key:"debounce",value:function(t,e){var n;return function(){for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];clearTimeout(n),n=setTimeout((function(){clearTimeout(n),t.apply(void 0,a)}),e)}}},{key:"showMsg",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"info";"undefined"!=typeof Swal?Swal.mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,didOpen:function(t){t.addEventListener("mouseenter",Swal.stopTimer),t.addEventListener("mouseleave",Swal.resumeTimer)}}).fire({icon:e,title:t}):console.log("".concat(e,": ").concat(t))}},{key:"showErr",value:function(t){this.showMsg(t,"error")}},{key:"destroy",value:function(){}}],e&&m(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,n,i,s,c,u}()}}]);