/*! For license information please see 454.bundle.js.LICENSE.txt */
"use strict";(self.webpackChunkapp_starter_project_with_webpack=self.webpackChunkapp_starter_project_with_webpack||[]).push([[454],{454:(t,n,e)=>{e.r(n),e.d(n,{default:()=>b});var r=e(330),i=e(805);function o(t){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o(t)}function a(){var t=v(),n=t.m(a),e=(Object.getPrototypeOf?Object.getPrototypeOf(n):n.__proto__).constructor;function r(t){var n="function"==typeof t&&t.constructor;return!!n&&(n===e||"GeneratorFunction"===(n.displayName||n.name))}var i={throw:1,return:2,break:3,continue:3};function o(t){var n,e;return function(r){n||(n={stop:function(){return e(r.a,2)},catch:function(){return r.v},abrupt:function(t,n){return e(r.a,i[t],n)},delegateYield:function(t,i,o){return n.resultName=i,e(r.d,c(t),o)},finish:function(t){return e(r.f,t)}},e=function(t,e,i){r.p=n.prev,r.n=n.next;try{return t(e,i)}finally{n.next=r.n}}),n.resultName&&(n[n.resultName]=r.v,n.resultName=void 0),n.sent=r.v,n.next=r.n;try{return t.call(this,n)}finally{r.p=n.prev,r.n=n.next}}}return(a=function(){return{wrap:function(n,e,r,i){return t.w(o(n),e,r,i&&i.reverse())},isGeneratorFunction:r,mark:t.m,awrap:function(t,n){return new d(t,n)},AsyncIterator:f,async:function(t,n,e,i,a){return(r(n)?l:u)(o(t),n,e,i,a)},keys:s,values:c}})()}function c(t){if(null!=t){var n=t["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],e=0;if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length))return{next:function(){return t&&e>=t.length&&(t=void 0),{value:t&&t[e++],done:!t}}}}throw new TypeError(o(t)+" is not iterable")}function s(t){var n=Object(t),e=[];for(var r in n)e.unshift(r);return function t(){for(;e.length;)if((r=e.pop())in n)return t.value=r,t.done=!1,t;return t.done=!0,t}}function u(t,n,e,r,i){var o=l(t,n,e,r,i);return o.next().then((function(t){return t.done?t.value:o.next()}))}function l(t,n,e,r,i){return new f(v().w(t,n,e,r),i||Promise)}function f(t,n){function e(r,i,o,a){try{var c=t[r](i),s=c.value;return s instanceof d?n.resolve(s.v).then((function(t){e("next",t,o,a)}),(function(t){e("throw",t,o,a)})):n.resolve(s).then((function(t){c.value=t,o(c)}),(function(t){return e("throw",t,o,a)}))}catch(t){a(t)}}var r;this.next||(p(f.prototype),p(f.prototype,"function"==typeof Symbol&&Symbol.asyncIterator||"@asyncIterator",(function(){return this}))),p(this,"_invoke",(function(t,i,o){function a(){return new n((function(n,r){e(t,o,n,r)}))}return r=r?r.then(a,a):a()}),!0)}function v(){var t,n,e="function"==typeof Symbol?Symbol:{},r=e.iterator||"@@iterator",i=e.toStringTag||"@@toStringTag";function o(e,r,i,o){var s=r&&r.prototype instanceof c?r:c,u=Object.create(s.prototype);return p(u,"_invoke",function(e,r,i){var o,c,s,u=0,l=i||[],f=!1,v={p:0,n:0,v:t,a:p,f:p.bind(t,4),d:function(n,e){return o=n,c=0,s=t,v.n=e,a}};function p(e,r){for(c=e,s=r,n=0;!f&&u&&!i&&n<l.length;n++){var i,o=l[n],p=v.p,d=o[2];e>3?(i=d===r)&&(s=o[(c=o[4])?5:(c=3,3)],o[4]=o[5]=t):o[0]<=p&&((i=e<2&&p<o[1])?(c=0,v.v=r,v.n=o[1]):p<d&&(i=e<3||o[0]>r||r>d)&&(o[4]=e,o[5]=r,v.n=d,c=0))}if(i||e>1)return a;throw f=!0,r}return function(i,l,d){if(u>1)throw TypeError("Generator is already running");for(f&&1===l&&p(l,d),c=l,s=d;(n=c<2?t:s)||!f;){o||(c?c<3?(c>1&&(v.n=-1),p(c,s)):v.n=s:v.v=s);try{if(u=2,o){if(c||(i="next"),n=o[i]){if(!(n=n.call(o,s)))throw TypeError("iterator result is not an object");if(!n.done)return n;s=n.value,c<2&&(c=0)}else 1===c&&(n=o.return)&&n.call(o),c<2&&(s=TypeError("The iterator does not provide a '"+i+"' method"),c=1);o=t}else if((n=(f=v.n<0)?s:e.call(r,v))!==a)break}catch(n){o=t,c=1,s=n}finally{u=1}}return{value:n,done:f}}}(e,i,o),!0),u}var a={};function c(){}function s(){}function u(){}n=Object.getPrototypeOf;var l=[][r]?n(n([][r]())):(p(n={},r,(function(){return this})),n),f=u.prototype=c.prototype=Object.create(l);function d(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,u):(t.__proto__=u,p(t,i,"GeneratorFunction")),t.prototype=Object.create(f),t}return s.prototype=u,p(f,"constructor",u),p(u,"constructor",s),s.displayName="GeneratorFunction",p(u,i,"GeneratorFunction"),p(f),p(f,i,"Generator"),p(f,r,(function(){return this})),p(f,"toString",(function(){return"[object Generator]"})),(v=function(){return{w:o,m:d}})()}function p(t,n,e,r){var i=Object.defineProperty;try{i({},"",{})}catch(t){i=0}p=function(t,n,e,r){function o(n,e){p(t,n,(function(t){return this._invoke(n,e,t)}))}n?i?i(t,n,{value:e,enumerable:!r,configurable:!r,writable:!r}):t[n]=e:(o("next",0),o("throw",1),o("return",2))},p(t,n,e,r)}function d(t,n){this.v=t,this.k=n}function h(t,n,e,r,i,o,a){try{var c=t[o](a),s=c.value}catch(t){return void e(t)}c.done?n(s):Promise.resolve(s).then(r,i)}function y(t){return function(){var n=this,e=arguments;return new Promise((function(r,i){var o=t.apply(n,e);function a(t){h(o,r,i,a,c,"next",t)}function c(t){h(o,r,i,a,c,"throw",t)}a(void 0)}))}}function m(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,w(r.key),r)}}function w(t){var n=function(t){if("object"!=o(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var e=n.call(t,"string");if("object"!=o(e))return e;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==o(n)?n:n+""}const b=function(){return t=function t(){!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,t),this.element=null,this.items=[],this.filtItems=[],this.curFilt={srch:"",sort:"createdAt",order:"desc",owner:""},this.uniqOwners=[]},n=[{key:"createView",value:function(){var t=this,n=document.createElement("section");return n.className="pg fav-pg",n.innerHTML='\n            <div class="fav-page">\n                <div class="page-hdr">\n                    <h1> Cerita Favorit</h1>\n                    <p>Kelola cerita yang Anda tandai sebagai fav</p>\n                </div>\n\n                <div class="sync-sts" id="syncSts"></div>\n\n                <div class="fav-ctrl">\n                    <div class="srch-box">\n                        <input type="text" id="srchFav" placeholder="Cari cerita favoritmu" \n                               value="'.concat(this.curFilt.srch,'">\n                        <span class="srch-ico">üîç</span>\n                    </div>\n\n                    <div class="fltr-ctrl">\n                        <select id="sortBy">\n                            <option value="createdAt" ').concat("createdAt"===this.curFilt.sort?"selected":"",'>By Tanggal</option>\n                            <option value="name" ').concat("name"===this.curFilt.sort?"selected":"",'>By Nama</option>\n                        </select>\n\n                        <select id="sortOrd">\n                            <option value="desc" ').concat("desc"===this.curFilt.order?"selected":"",'>Terbaru</option>\n                            <option value="asc" ').concat("asc"===this.curFilt.order?"selected":"",'>Terlama</option>\n                        </select>\n\n                        <select id="fltrOwn">\n                            <option value="">All Penulis</option>\n                            ').concat(this.uniqOwners.map((function(n){return'<option value="'.concat(n,'" ').concat(t.curFilt.owner===n?"selected":"",">").concat(n,"</option>")})).join(""),'\n                        </select>\n                    </div>\n                </div>\n\n                <div class="fav-list" id="favList">\n                    <div class="loading">Loading fav...</div>\n                </div>\n\n                <div class="empty-st" id="emptySt" style="display: none;">\n                    <div class="empty-ico">üìö</div>\n                    <h3>Belum ada cerita fav</h3>\n                    <p>Tambahkan cerita ke fav untuk melihat di sini</p>\n                </div>\n            </div>\n        '),this.element=n,n}},{key:"init",value:(u=y(a().mark((function t(){return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.element||this.createView(),t.next=3,this.afterRender();case 3:case"end":return t.stop()}}),t,this)}))),function(){return u.apply(this,arguments)})},{key:"afterRender",value:(s=y(a().mark((function t(){return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.loadFav();case 2:this.setupEvt(),this.setupSyncEvt();case 4:case"end":return t.stop()}}),t,this)}))),function(){return s.apply(this,arguments)})},{key:"loadFav",value:(c=y(a().mark((function t(){return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,r.U.getFav(this.curFilt);case 3:return this.items=t.sent,t.next=6,r.U.getUniqOwners();case 6:this.uniqOwners=t.sent,this.updateUI(),this.updateSyncSts(),t.next=15;break;case 11:t.prev=11,t.t0=t.catch(0),console.error("Error load fav:",t.t0),this.showErr("Gagal load fav");case 15:case"end":return t.stop()}}),t,this,[[0,11]])}))),function(){return c.apply(this,arguments)})},{key:"updateUI",value:function(){if(this.element){var t=this.element.querySelector("#favList"),n=this.element.querySelector("#emptySt");if(t&&n){if(0===this.items.length)return t.innerHTML="",void(n.style.display="block");n.style.display="none",t.innerHTML=this.items.map((function(t){var n;return'\n            <div class="fav-item" data-id="'.concat(t.id,'">\n                <div class="item-img">\n                    <img src="').concat(t.photoUrl,'" \n                         alt="').concat(t.name||"Story",'" \n                         onerror="this.src=\'/images/Logo.png\'">\n                    ').concat(t.pendingSync?'<span class="sync-bdg">‚è≥ Offline</span>':"",'\n                </div>\n                \n                <div class="item-cont">\n                    <h3 class="item-title">').concat(t.name||"No Title",'</h3>\n                    <p class="item-desc">').concat(t.description||"No desc",'</p>\n                    \n                    <div class="item-meta">\n                        <span class="item-own">üë§ ').concat((null===(n=t.owner)||void 0===n?void 0:n.name)||"Unknown",'</span>\n                        <span class="item-date">üìÖ ').concat(new Date(t.createdAt).toLocaleDateString("id-ID"),'</span>\n                    </div>\n                </div>\n                \n                <div class="item-act">\n                    <button class="btn-rmv" data-id="').concat(t.id,'" title="Hapus fav">\n                        ‚ùå\n                    </button>\n                </div>\n            </div>\n        ')})).join(""),this.updateOwnFltr()}}}},{key:"updateOwnFltr",value:function(){var t=this;if(this.element){var n=this.element.querySelector("#fltrOwn");n&&(n.innerHTML='\n            <option value="">All Penulis</option>\n            '.concat(this.uniqOwners.map((function(n){return'<option value="'.concat(n,'" ').concat(t.curFilt.owner===n?"selected":"",">").concat(n,"</option>")})).join(""),"\n        "))}}},{key:"updateSyncSts",value:(o=y(a().mark((function t(){var n,e;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.element){t.next=2;break}return t.abrupt("return");case 2:if(n=this.element.querySelector("#syncSts")){t.next=5;break}return t.abrupt("return");case 5:return t.next=7,i.J.getSyncSts();case 7:e=t.sent,n.innerHTML='\n            <div class="sync-sts-cont '.concat(e.isOnline?"on":"off",'">\n                <span class="sts-ind"></span>\n                <span class="sts-txt">\n                    ').concat(e.isOnline?"üü¢ Online":"üî¥ Offline"," | \n                    ").concat(e.pendingSyncCount," pending |\n                    ").concat(e.totalFav," favorit\n                </span>\n            </div>\n        ");case 9:case"end":return t.stop()}}),t,this)}))),function(){return o.apply(this,arguments)})},{key:"setupEvt",value:function(){var t=this;if(this.element){var n=this.element.querySelector("#srchFav");n&&n.addEventListener("input",(function(n){t.curFilt.srch=n.target.value,t.debLoadFav()}));var e=this.element.querySelector("#sortBy");e&&e.addEventListener("change",(function(n){t.curFilt.sort=n.target.value,t.loadFav()}));var r=this.element.querySelector("#sortOrd");r&&r.addEventListener("change",(function(n){t.curFilt.order=n.target.value,t.loadFav()}));var i=this.element.querySelector("#fltrOwn");i&&i.addEventListener("change",(function(n){t.curFilt.owner=n.target.value,t.loadFav()})),this.element.addEventListener("click",function(){var n=y(a().mark((function n(e){var r;return a().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!e.target.classList.contains("btn-rmv")){n.next=4;break}return r=e.target.dataset.id,n.next=4,t.rmvFav(r);case 4:case"end":return n.stop()}}),n)})));return function(t){return n.apply(this,arguments)}}())}}},{key:"setupSyncEvt",value:function(){var t=this;window.addEventListener("storySynced",(function(n){t.showMsg("Sync success!","success"),t.loadFav()})),window.addEventListener("syncCompleted",(function(n){t.showMsg("All offline stories synced!","success"),t.loadFav()})),window.addEventListener("storySavedOffline",(function(n){t.showMsg("Saved offline, will sync later","info")}))}},{key:"rmvFav",value:(e=y(a().mark((function t(n){return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("undefined"==typeof Swal){t.next=19;break}return t.next=3,Swal.fire({title:"Hapus dari Favorit?",text:"Cerita akan dihapus dari daftar favorit Anda",icon:"warning",showCancelButton:!0,confirmButtonColor:"#EF4444",cancelButtonColor:"#64748b",confirmButtonText:"Ya, Hapus",cancelButtonText:"Batal"});case 3:if(!t.sent.isConfirmed){t.next=17;break}return t.prev=5,t.next=8,r.U.rmvFav(n);case 8:return this.showMsg("Berhasil dihapus dari favorit","success"),t.next=11,this.loadFav();case 11:t.next=17;break;case 13:t.prev=13,t.t0=t.catch(5),console.error("Error remove fav:",t.t0),this.showMsg("Gagal menghapus dari favorit","error");case 17:t.next=32;break;case 19:if(!confirm("Hapus dari fav?")){t.next=32;break}return t.prev=20,t.next=23,r.U.rmvFav(n);case 23:return this.showMsg("Deleted from fav","success"),t.next=26,this.loadFav();case 26:t.next=32;break;case 28:t.prev=28,t.t1=t.catch(20),console.error("Error remove fav:",t.t1),this.showMsg("Gagal hapus fav","error");case 32:case"end":return t.stop()}}),t,this,[[5,13],[20,28]])}))),function(t){return e.apply(this,arguments)})},{key:"showMsg",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"info";"undefined"!=typeof Swal?Swal.mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,didOpen:function(t){t.addEventListener("mouseenter",Swal.stopTimer),t.addEventListener("mouseleave",Swal.resumeTimer)}}).fire({icon:n,title:t}):console.log("".concat(n,": ").concat(t))}},{key:"showErr",value:function(t){this.showMsg(t,"error")}},{key:"destroy",value:function(){}}],n&&m(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,n,e,o,c,s,u}()}}]);