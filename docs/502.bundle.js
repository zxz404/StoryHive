/*! For license information please see 502.bundle.js.LICENSE.txt */
"use strict";(self.webpackChunkapp_starter_project_with_webpack=self.webpackChunkapp_starter_project_with_webpack||[]).push([[502],{502:(t,e,n)=>{n.r(e),n.d(e,{SDetailPg:()=>b});var r=n(775);function i(t){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(t)}function a(){var t=d(),e=t.m(a),n=(Object.getPrototypeOf?Object.getPrototypeOf(e):e.__proto__).constructor;function r(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===n||"GeneratorFunction"===(e.displayName||e.name))}var i={throw:1,return:2,break:3,continue:3};function h(t){var e,n;return function(r){e||(e={stop:function(){return n(r.a,2)},catch:function(){return r.v},abrupt:function(t,e){return n(r.a,i[t],e)},delegateYield:function(t,i,a){return e.resultName=i,n(r.d,o(t),a)},finish:function(t){return n(r.f,t)}},n=function(t,n,i){r.p=e.prev,r.n=e.next;try{return t(n,i)}finally{e.next=r.n}}),e.resultName&&(e[e.resultName]=r.v,e.resultName=void 0),e.sent=r.v,e.next=r.n;try{return t.call(this,e)}finally{r.p=e.prev,r.n=e.next}}}return(a=function(){return{wrap:function(e,n,r,i){return t.w(h(e),n,r,i&&i.reverse())},isGeneratorFunction:r,mark:t.m,awrap:function(t,e){return new v(t,e)},AsyncIterator:l,async:function(t,e,n,i,a){return(r(e)?u:c)(h(t),e,n,i,a)},keys:s,values:o}})()}function o(t){if(null!=t){var e=t["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],n=0;if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length))return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}}throw new TypeError(i(t)+" is not iterable")}function s(t){var e=Object(t),n=[];for(var r in e)n.unshift(r);return function t(){for(;n.length;)if((r=n.pop())in e)return t.value=r,t.done=!1,t;return t.done=!0,t}}function c(t,e,n,r,i){var a=u(t,e,n,r,i);return a.next().then((function(t){return t.done?t.value:a.next()}))}function u(t,e,n,r,i){return new l(d().w(t,e,n,r),i||Promise)}function l(t,e){function n(r,i,a,o){try{var s=t[r](i),c=s.value;return c instanceof v?e.resolve(c.v).then((function(t){n("next",t,a,o)}),(function(t){n("throw",t,a,o)})):e.resolve(c).then((function(t){s.value=t,a(s)}),(function(t){return n("throw",t,a,o)}))}catch(t){o(t)}}var r;this.next||(h(l.prototype),h(l.prototype,"function"==typeof Symbol&&Symbol.asyncIterator||"@asyncIterator",(function(){return this}))),h(this,"_invoke",(function(t,i,a){function o(){return new e((function(e,r){n(t,a,e,r)}))}return r=r?r.then(o,o):o()}),!0)}function d(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",i=n.toStringTag||"@@toStringTag";function a(n,r,i,a){var c=r&&r.prototype instanceof s?r:s,u=Object.create(c.prototype);return h(u,"_invoke",function(n,r,i){var a,s,c,u=0,l=i||[],d=!1,h={p:0,n:0,v:t,a:v,f:v.bind(t,4),d:function(e,n){return a=e,s=0,c=t,h.n=n,o}};function v(n,r){for(s=n,c=r,e=0;!d&&u&&!i&&e<l.length;e++){var i,a=l[e],v=h.p,f=a[2];n>3?(i=f===r)&&(c=a[(s=a[4])?5:(s=3,3)],a[4]=a[5]=t):a[0]<=v&&((i=n<2&&v<a[1])?(s=0,h.v=r,h.n=a[1]):v<f&&(i=n<3||a[0]>r||r>f)&&(a[4]=n,a[5]=r,h.n=f,s=0))}if(i||n>1)return o;throw d=!0,r}return function(i,l,f){if(u>1)throw TypeError("Generator is already running");for(d&&1===l&&v(l,f),s=l,c=f;(e=s<2?t:c)||!d;){a||(s?s<3?(s>1&&(h.n=-1),v(s,c)):h.n=c:h.v=c);try{if(u=2,a){if(s||(i="next"),e=a[i]){if(!(e=e.call(a,c)))throw TypeError("iterator result is not an object");if(!e.done)return e;c=e.value,s<2&&(s=0)}else 1===s&&(e=a.return)&&e.call(a),s<2&&(c=TypeError("The iterator does not provide a '"+i+"' method"),s=1);a=t}else if((e=(d=h.n<0)?c:n.call(r,h))!==o)break}catch(e){a=t,s=1,c=e}finally{u=1}}return{value:e,done:d}}}(n,i,a),!0),u}var o={};function s(){}function c(){}function u(){}e=Object.getPrototypeOf;var l=[][r]?e(e([][r]())):(h(e={},r,(function(){return this})),e),v=u.prototype=s.prototype=Object.create(l);function f(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,u):(t.__proto__=u,h(t,i,"GeneratorFunction")),t.prototype=Object.create(v),t}return c.prototype=u,h(v,"constructor",u),h(u,"constructor",c),c.displayName="GeneratorFunction",h(u,i,"GeneratorFunction"),h(v),h(v,i,"Generator"),h(v,r,(function(){return this})),h(v,"toString",(function(){return"[object Generator]"})),(d=function(){return{w:a,m:f}})()}function h(t,e,n,r){var i=Object.defineProperty;try{i({},"",{})}catch(t){i=0}h=function(t,e,n,r){function a(e,n){h(t,e,(function(t){return this._invoke(e,n,t)}))}e?i?i(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n:(a("next",0),a("throw",1),a("return",2))},h(t,e,n,r)}function v(t,e){this.v=t,this.k=e}function f(t,e,n,r,i,a,o){try{var s=t[a](o),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(r,i)}function p(t){return function(){var e=this,n=arguments;return new Promise((function(r,i){var a=t.apply(e,n);function o(t){f(a,r,i,o,s,"next",t)}function s(t){f(a,r,i,o,s,"throw",t)}o(void 0)}))}}function y(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,m(r.key),r)}}function m(t){var e=function(t){if("object"!=i(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=i(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==i(e)?e:e+""}var b=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.element=this.createView(),this.map=null,this.currentStoryId=null,this.currentStory=null,this.allStories=[],this.currentIndex=-1},e=[{key:"createView",value:function(){var t=document.createElement("section");return t.className="pg s-detail-pg",t.innerHTML='\n            <div class="s-detail-cntnr">\n                <nav class="breadcrumb" aria-label="Breadcrumb">\n                    <a href="#/home" class="btn-back" aria-label="Kembali ke beranda">\n                        ‚Üê Kembali ke Beranda\n                    </a>\n                </nav>\n\n                <div id="loading-indicator" class="is-loading" role="status" aria-live="polite">\n                    Memuat detail cerita...\n                </div>\n\n                <div id="error-message" class="error-msg is-hidden" role="alert"></div>\n\n                <article id="story-content" class="s-cnt is-hidden" aria-labelledby="s-title">\n                    <header class="s-hdr">\n                        <div class="s-meta">\n                            <h1 id="s-title" class="s-title">Judul Cerita</h1>\n                            <div class="author-info">\n                                <span class="author-name" id="author-name">Nama Penulis</span>\n                                <span class="publish-date" id="publish-date">Tanggal Publikasi</span>\n                            </div>\n                        </div>\n                        <div class="s-actions">\n                            <button id="btn-fav" class="btn-fav" \n                                    aria-label="Tambah ke favorit">\n                                ü§ç Tambah ke Favorit\n                            </button>\n                        </div>\n                    </header>\n\n                    <div class="s-body">\n                        <figure class="s-img-cntnr">\n                            <img \n                                id="s-img" \n                                src="" \n                                alt="" \n                                class="s-img"\n                            >\n                            <figcaption class="img-caption" id="img-caption">\n                                Gambar ilustrasi cerita\n                            </figcaption>\n                        </figure>\n\n                        <div class="s-desc-cntnr">\n                            <p id="s-desc" class="s-desc">\n                                Deskripsi cerita akan ditampilkan di sini...\n                            </p>\n                        </div>\n\n                        <section class="s-loc" aria-labelledby="location-title">\n                            <h2 id="location-title">üìç Lokasi Cerita</h2>\n                            <div class="loc-details">\n                                <div class="coords">\n                                    <div class="coord">\n                                        <strong>Latitude:</strong>\n                                        <span id="detail-latitude">-</span>\n                                    </div>\n                                    <div class="coord">\n                                        <strong>Longitude:</strong>\n                                        <span id="detail-longitude">-</span>\n                                    </div>\n                                </div>\n                                <button id="btn-view-map" class="btn-secondary">\n                                    Lihat di Peta Besar\n                                </button>\n                            </div>\n                            <div id="detail-map" class="detail-map" aria-label="Peta lokasi cerita"></div>\n                        </section>\n                    </div>\n\n                    <footer class="s-footer">\n                        <div class="act-btns">\n                            <button id="btn-prev" class="btn-secondary" disabled>\n                                ‚Üê Cerita Sebelumnya\n                            </button>\n                            <button id="btn-next" class="btn-secondary" disabled>\n                                Cerita Selanjutnya ‚Üí\n                            </button>\n                        </div>\n                    </footer>\n                </article>\n            </div>\n        ',t}},{key:"init",value:(d=p(a().mark((function t(){var e,n=arguments;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e=n.length>0&&void 0!==n[0]?n[0]:null,t.prev=1,console.log("Initializing story detail with route:",e),!e){t.next=8;break}return t.next=6,this.extractStoryIdFromRoute(e);case 6:t.next=10;break;case 8:return t.next=10,this.extractStoryIdFromHash();case 10:return console.log("Story ID:",this.currentStoryId),t.next=13,this.loadAllStories();case 13:return t.next=15,this.loadStoryDetail();case 15:this.setupEventHandlers(),t.next=21;break;case 18:t.prev=18,t.t0=t.catch(1),this.showError("Gagal memuat detail cerita: "+t.t0.message);case 21:case"end":return t.stop()}}),t,this,[[1,18]])}))),function(){return d.apply(this,arguments)})},{key:"extractStoryIdFromRoute",value:(l=p(a().mark((function t(e){var n;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(n=e.match(/\/s\/([^\/]+)/))||!n[1]){t.next=5;break}this.currentStoryId=n[1],t.next=6;break;case 5:throw new Error("ID cerita tidak valid dari route");case 6:case"end":return t.stop()}}),t,this)}))),function(t){return l.apply(this,arguments)})},{key:"extractStoryIdFromHash",value:(u=p(a().mark((function t(){var e,n;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e=window.location.hash,!(n=e.match(/\/s\/([^\/]+)/))||!n[1]){t.next=6;break}this.currentStoryId=n[1],t.next=7;break;case 6:throw new Error("ID cerita tidak valid dari hash");case 7:case"end":return t.stop()}}),t,this)}))),function(){return u.apply(this,arguments)})},{key:"loadAllStories",value:(c=p(a().mark((function t(){return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,r.default.getStories();case 3:this.allStories=t.sent,t.next=10;break;case 6:t.prev=6,t.t0=t.catch(0),console.error("Error loading stories:",t.t0),this.allStories=[];case 10:case"end":return t.stop()}}),t,this,[[0,6]])}))),function(){return c.apply(this,arguments)})},{key:"loadStoryDetail",value:(s=p(a().mark((function t(){return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.showLoading(),t.prev=1,t.next=4,r.default.getStoryDetail(this.currentStoryId);case 4:this.currentStory=t.sent,this.displayStory(this.currentStory),this.currentStory.lat&&this.currentStory.lon&&(this.map=this.initializeMap(this.currentStory.lat,this.currentStory.lon)),this.updateStoryNavigation(),t.next=13;break;case 10:t.prev=10,t.t0=t.catch(1),this.showError("Gagal memuat detail cerita: "+t.t0.message);case 13:case"end":return t.stop()}}),t,this,[[1,10]])}))),function(){return s.apply(this,arguments)})},{key:"updateStoryNavigation",value:function(){var t=this;if(0!==this.allStories.length){this.currentIndex=this.allStories.findIndex((function(e){return e.id===t.currentStoryId}));var e=this.currentIndex>0,n=this.currentIndex<this.allStories.length-1;this.updateNavigationButtons(e,n)}}},{key:"setupEventHandlers",value:function(){this.bindBackButton(),this.bindNavigationButtons(),this.bindViewOnMap(),this.setupFavButton()}},{key:"setupFavButton",value:(o=p(a().mark((function t(){var e,n,r=this;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if((e=this.element.querySelector("#btn-fav"))&&this.currentStory){t.next=3;break}return t.abrupt("return");case 3:return t.next=5,this.isStoryFav(this.currentStory.id);case 5:n=t.sent,this.updateFavButton(n),e.addEventListener("click",p(a().mark((function t(){return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,r.toggleFav();case 2:case"end":return t.stop()}}),t)}))));case 8:case"end":return t.stop()}}),t,this)}))),function(){return o.apply(this,arguments)})},{key:"isStoryFav",value:(i=p(a().mark((function t(e){return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,"undefined"==typeof app||"function"!=typeof app.isStoryFav){t.next=5;break}return t.next=4,app.isStoryFav(e);case 4:return t.abrupt("return",t.sent);case 5:return t.abrupt("return",!1);case 8:return t.prev=8,t.t0=t.catch(0),console.error("Error checking fav status:",t.t0),t.abrupt("return",!1);case 12:case"end":return t.stop()}}),t,null,[[0,8]])}))),function(t){return i.apply(this,arguments)})},{key:"toggleFav",value:(n=p(a().mark((function t(){var e;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,this.currentStory){t.next=3;break}return t.abrupt("return");case 3:return t.next=5,this.isStoryFav(this.currentStory.id);case 5:if(!(e=t.sent)){t.next=11;break}return t.next=9,app.removeFromFav(this.currentStory.id);case 9:t.next=13;break;case 11:return t.next=13,app.addToFav(this.currentStory);case 13:this.updateFavButton(!e),t.next=20;break;case 16:t.prev=16,t.t0=t.catch(0),console.error("Error toggling favorite:",t.t0),this.showAlert("Error","Gagal mengubah status favorit","error");case 20:case"end":return t.stop()}}),t,this,[[0,16]])}))),function(){return n.apply(this,arguments)})},{key:"updateFavButton",value:function(t){var e=this.element.querySelector("#btn-fav");e&&(e.classList.toggle("is-fav",t),e.innerHTML=t?"‚ù§Ô∏è Di Favorit":"ü§ç Tambah ke Favorit",e.setAttribute("aria-label",t?"Hapus dari favorit":"Tambah ke favorit"))}},{key:"displayStory",value:function(t){var e,n,r=this.element.querySelector("#loading-indicator"),i=this.element.querySelector("#error-message"),a=this.element.querySelector("#story-content");r.classList.add("is-hidden"),i.classList.add("is-hidden"),a.classList.remove("is-hidden"),this.element.querySelector("#s-title").textContent=t.name,this.element.querySelector("#author-name").textContent=t.name,this.element.querySelector("#publish-date").textContent=this.formatDate(t.createdAt),this.element.querySelector("#s-desc").textContent=t.description;var o=this.element.querySelector("#s-img");o.src=t.photoUrl,o.alt=t.description,this.element.querySelector("#img-caption").textContent=t.description,this.element.querySelector("#detail-latitude").textContent=(null===(e=t.lat)||void 0===e?void 0:e.toFixed(6))||"-",this.element.querySelector("#detail-longitude").textContent=(null===(n=t.lon)||void 0===n?void 0:n.toFixed(6))||"-"}},{key:"showLoading",value:function(){var t=this.element.querySelector("#loading-indicator"),e=this.element.querySelector("#error-message"),n=this.element.querySelector("#story-content");t.classList.remove("is-hidden"),e.classList.add("is-hidden"),n.classList.add("is-hidden")}},{key:"showError",value:function(t){var e=this.element.querySelector("#loading-indicator"),n=this.element.querySelector("#error-message"),r=this.element.querySelector("#story-content");e.classList.add("is-hidden"),n.textContent=t,n.classList.remove("is-hidden"),r.classList.add("is-hidden")}},{key:"bindBackButton",value:function(){this.element.querySelector(".btn-back").addEventListener("click",(function(t){t.preventDefault(),window.location.hash="#/home"}))}},{key:"bindNavigationButtons",value:function(){var t=this,e=this.element.querySelector("#btn-prev"),n=this.element.querySelector("#btn-next");e.addEventListener("click",(function(){return t.handlePrevStory()})),n.addEventListener("click",(function(){return t.handleNextStory()}))}},{key:"updateNavigationButtons",value:function(t,e){var n=this.element.querySelector("#btn-prev"),r=this.element.querySelector("#btn-next");n.disabled=!t,r.disabled=!e,n.setAttribute("aria-label",t?"Baca cerita sebelumnya":"Tidak ada cerita sebelumnya"),r.setAttribute("aria-label",e?"Baca cerita selanjutnya":"Tidak ada cerita selanjutnya")}},{key:"handlePrevStory",value:function(){if(this.currentIndex>0){var t=this.allStories[this.currentIndex-1];this.navigateToStory(t.id)}}},{key:"handleNextStory",value:function(){if(this.currentIndex<this.allStories.length-1){var t=this.allStories[this.currentIndex+1];this.navigateToStory(t.id)}}},{key:"navigateToStory",value:function(t){window.location.hash="#/s/".concat(t)}},{key:"initializeMap",value:function(t,e){var n=this.element.querySelector("#detail-map");if(!t||!e)return n.innerHTML='\n                <div class="no-loc-msg">\n                    <p>Lokasi tidak tersedia untuk cerita ini</p>\n                </div>\n            ',null;var r=L.map("detail-map").setView([t,e],13);return L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:"¬© OpenStreetMap contributors",maxZoom:18}).addTo(r),L.marker([t,e]).addTo(r).bindPopup('\n                <div class="map-popup">\n                    <strong>Lokasi Cerita</strong><br>\n                    '.concat(this.element.querySelector("#s-title").textContent,"\n                </div>\n            ")).openPopup(),r}},{key:"bindViewOnMap",value:function(){var t=this;this.element.querySelector("#btn-view-map").addEventListener("click",(function(){var e,n;null!==(e=t.currentStory)&&void 0!==e&&e.lat&&null!==(n=t.currentStory)&&void 0!==n&&n.lon&&(window.location.hash="#/home?focus=".concat(t.currentStory.id))}))}},{key:"formatDate",value:function(t){return new Date(t).toLocaleDateString("id-ID",{weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})}},{key:"showAlert",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"error";"undefined"!=typeof Swal?Swal.fire({icon:n,title:t,text:e,confirmButtonText:"OK",confirmButtonColor:"error"===n?"#dc2626":"#2563eb"}):alert("".concat(t,": ").concat(e))}},{key:"destroy",value:function(){var t=this.element.querySelector("#detail-map");t._leaflet_map&&t._leaflet_map.remove()}}],e&&y(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,n,i,o,s,c,u,l,d}()}}]);