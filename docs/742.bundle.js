/*! For license information please see 742.bundle.js.LICENSE.txt */
"use strict";(self.webpackChunkapp_starter_project_with_webpack=self.webpackChunkapp_starter_project_with_webpack||[]).push([[742],{146:(t,e,n)=>{function r(t){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r(t)}function a(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,i(r.key),r)}}function i(t){var e=function(t){if("object"!=r(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=r(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==r(e)?e:e+""}n.d(e,{A:()=>o});const o=function(){return t=function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.containerId=e,this.options=n,this.map=null,this.markers={},this.activeMarker=null,this.tileLayers={},this.init()},e=[{key:"init",value:function(){this.map=L.map(this.containerId,{center:this.options.center||[-6.2088,106.8456],zoom:this.options.zoom||10,zoomControl:!1}),L.control.zoom({position:"bottomright"}).addTo(this.map),this.setupTileLayers(),this.setupLayerControl()}},{key:"setupTileLayers",value:function(){this.tileLayers.openstreetmap=L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:"¬© OpenStreetMap contributors",maxZoom:19}),this.tileLayers.satellite=L.tileLayer("https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}",{attribution:"Tiles &copy; Esri &mdash; Source: Esri, i-cubed, USDA, USGS, AEX, GeoEye, Getmapping, Aerogrid, IGN, IGP, UPR-EGP, and the GIS User Community",maxZoom:19}),this.tileLayers.openstreetmap.addTo(this.map),this.currentTileLayer="openstreetmap"}},{key:"setupLayerControl",value:function(){this.layerControl=L.control.layers(this.tileLayers).addTo(this.map)}},{key:"addMarker",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=L.marker([t.lat,t.lon],{title:t.name}),r='\n            <div class="story-popup">\n                <img src="'.concat(t.photoUrl,'" alt="').concat(t.description,'" style="width: 100px; height: 100px; object-fit: cover; border-radius: 8px;">\n                <div style="margin-top: 8px;">\n                    <strong>').concat(t.name,'</strong>\n                    <p style="margin: 4px 0; font-size: 0.9em;">').concat(t.description,'</p>\n                    <small style="color: #666;">').concat(new Date(t.createdAt).toLocaleDateString("id-ID"),"</small>\n                </div>\n            </div>\n        ");return n.bindPopup(r),n.addTo(this.map),this.markers[t.id]=n,e.onClick&&n.on("click",(function(){return e.onClick(t)})),n}},{key:"removeMarker",value:function(t){this.markers[t]&&(this.map.removeLayer(this.markers[t]),delete this.markers[t])}},{key:"clearMarkers",value:function(){var t=this;Object.values(this.markers).forEach((function(e){t.map.removeLayer(e)})),this.markers={}}},{key:"setActiveMarker",value:function(t){this.activeMarker&&this.markers[this.activeMarker]&&this.markers[this.activeMarker].setIcon(this.getDefaultIcon()),this.markers[t]&&(this.markers[t].setIcon(this.getActiveIcon()),this.activeMarker=t,this.map.panTo(this.markers[t].getLatLng()),this.markers[t].openPopup())}},{key:"getDefaultIcon",value:function(){return L.icon({iconUrl:"https://unpkg.com/leaflet@1.9.4/dist/images/marker-icon.png",shadowUrl:"https://unpkg.com/leaflet@1.9.4/dist/images/marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41]})}},{key:"getActiveIcon",value:function(){return L.icon({iconUrl:"https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-2x-red.png",shadowUrl:"https://unpkg.com/leaflet@1.9.4/dist/images/marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41]})}},{key:"onMapClick",value:function(t){this.map.on("click",(function(e){t(e.latlng.lat,e.latlng.lng)}))}},{key:"setView",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:15;this.map.setView([t,e],n)}},{key:"destroy",value:function(){this.map&&(this.map.remove(),this.map=null)}}],e&&a(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}()},742:(t,e,n)=>{n.r(e),n.d(e,{HomePg:()=>x});var r=n(146),a=n(775);function i(t){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(t)}function o(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=c(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,a=function(){};return{s:a,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return o=t.done,t},e:function(t){s=!0,i=t},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function s(t){return function(t){if(Array.isArray(t))return l(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||c(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(t,e){if(t){if("string"==typeof t)return l(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?l(t,e):void 0}}function l(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function u(){var t=m(),e=t.m(u),n=(Object.getPrototypeOf?Object.getPrototypeOf(e):e.__proto__).constructor;function r(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===n||"GeneratorFunction"===(e.displayName||e.name))}var a={throw:1,return:2,break:3,continue:3};function i(t){var e,n;return function(r){e||(e={stop:function(){return n(r.a,2)},catch:function(){return r.v},abrupt:function(t,e){return n(r.a,a[t],e)},delegateYield:function(t,a,i){return e.resultName=a,n(r.d,d(t),i)},finish:function(t){return n(r.f,t)}},n=function(t,n,a){r.p=e.prev,r.n=e.next;try{return t(n,a)}finally{e.next=r.n}}),e.resultName&&(e[e.resultName]=r.v,e.resultName=void 0),e.sent=r.v,e.next=r.n;try{return t.call(this,e)}finally{r.p=e.prev,r.n=e.next}}}return(u=function(){return{wrap:function(e,n,r,a){return t.w(i(e),n,r,a&&a.reverse())},isGeneratorFunction:r,mark:t.m,awrap:function(t,e){return new b(t,e)},AsyncIterator:v,async:function(t,e,n,a,o){return(r(e)?h:f)(i(t),e,n,a,o)},keys:p,values:d}})()}function d(t){if(null!=t){var e=t["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],n=0;if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length))return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}}throw new TypeError(i(t)+" is not iterable")}function p(t){var e=Object(t),n=[];for(var r in e)n.unshift(r);return function t(){for(;n.length;)if((r=n.pop())in e)return t.value=r,t.done=!1,t;return t.done=!0,t}}function f(t,e,n,r,a){var i=h(t,e,n,r,a);return i.next().then((function(t){return t.done?t.value:i.next()}))}function h(t,e,n,r,a){return new v(m().w(t,e,n,r),a||Promise)}function v(t,e){function n(r,a,i,o){try{var s=t[r](a),c=s.value;return c instanceof b?e.resolve(c.v).then((function(t){n("next",t,i,o)}),(function(t){n("throw",t,i,o)})):e.resolve(c).then((function(t){s.value=t,i(s)}),(function(t){return n("throw",t,i,o)}))}catch(t){o(t)}}var r;this.next||(y(v.prototype),y(v.prototype,"function"==typeof Symbol&&Symbol.asyncIterator||"@asyncIterator",(function(){return this}))),y(this,"_invoke",(function(t,a,i){function o(){return new e((function(e,r){n(t,i,e,r)}))}return r=r?r.then(o,o):o()}),!0)}function m(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",a=n.toStringTag||"@@toStringTag";function i(n,r,a,i){var c=r&&r.prototype instanceof s?r:s,l=Object.create(c.prototype);return y(l,"_invoke",function(n,r,a){var i,s,c,l=0,u=a||[],d=!1,p={p:0,n:0,v:t,a:f,f:f.bind(t,4),d:function(e,n){return i=e,s=0,c=t,p.n=n,o}};function f(n,r){for(s=n,c=r,e=0;!d&&l&&!a&&e<u.length;e++){var a,i=u[e],f=p.p,h=i[2];n>3?(a=h===r)&&(c=i[(s=i[4])?5:(s=3,3)],i[4]=i[5]=t):i[0]<=f&&((a=n<2&&f<i[1])?(s=0,p.v=r,p.n=i[1]):f<h&&(a=n<3||i[0]>r||r>h)&&(i[4]=n,i[5]=r,p.n=h,s=0))}if(a||n>1)return o;throw d=!0,r}return function(a,u,h){if(l>1)throw TypeError("Generator is already running");for(d&&1===u&&f(u,h),s=u,c=h;(e=s<2?t:c)||!d;){i||(s?s<3?(s>1&&(p.n=-1),f(s,c)):p.n=c:p.v=c);try{if(l=2,i){if(s||(a="next"),e=i[a]){if(!(e=e.call(i,c)))throw TypeError("iterator result is not an object");if(!e.done)return e;c=e.value,s<2&&(s=0)}else 1===s&&(e=i.return)&&e.call(i),s<2&&(c=TypeError("The iterator does not provide a '"+a+"' method"),s=1);i=t}else if((e=(d=p.n<0)?c:n.call(r,p))!==o)break}catch(e){i=t,s=1,c=e}finally{l=1}}return{value:e,done:d}}}(n,a,i),!0),l}var o={};function s(){}function c(){}function l(){}e=Object.getPrototypeOf;var u=[][r]?e(e([][r]())):(y(e={},r,(function(){return this})),e),d=l.prototype=s.prototype=Object.create(u);function p(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,l):(t.__proto__=l,y(t,a,"GeneratorFunction")),t.prototype=Object.create(d),t}return c.prototype=l,y(d,"constructor",l),y(l,"constructor",c),c.displayName="GeneratorFunction",y(l,a,"GeneratorFunction"),y(d),y(d,a,"Generator"),y(d,r,(function(){return this})),y(d,"toString",(function(){return"[object Generator]"})),(m=function(){return{w:i,m:p}})()}function y(t,e,n,r){var a=Object.defineProperty;try{a({},"",{})}catch(t){a=0}y=function(t,e,n,r){function i(e,n){y(t,e,(function(t){return this._invoke(e,n,t)}))}e?a?a(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n:(i("next",0),i("throw",1),i("return",2))},y(t,e,n,r)}function b(t,e){this.v=t,this.k=e}function g(t,e,n,r,a,i,o){try{var s=t[i](o),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(r,a)}function k(t){return function(){var e=this,n=arguments;return new Promise((function(r,a){var i=t.apply(e,n);function o(t){g(i,r,a,o,s,"next",t)}function s(t){g(i,r,a,o,s,"throw",t)}o(void 0)}))}}function S(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,w(r.key),r)}}function w(t){var e=function(t){if("object"!=i(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=i(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==i(e)?e:e+""}var x=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.element=this.createView(),this.mapManager=null,this.stories=[],this.filteredStories=[],this.favStatus={}},e=[{key:"createView",value:function(){var t=document.createElement("section");return t.className="pg home-pg",t.innerHTML='\n            <div class="home-cntnr">\n                <section class="banner-sec" aria-labelledby="banner-title">\n                    <div class="banner-cnt">\n                        <h1 id="banner-title" class="banner-title">Temukan Cerita Menarik di Sekitar Anda</h1>\n                        <p class="banner-desc">\n                            Jelajahi pengalaman unik dan berbagi kisah inspiratif dari berbagai lokasi\n                        </p>\n                        <div class="banner-stats">\n                            <div class="stat-item">\n                                <span class="stat-num" id="stories-count" aria-live="polite">0</span>\n                                <span class="stat-label">Cerita Dibagikan</span>\n                            </div>\n                            <div class="stat-item">\n                                <span class="stat-num" id="locations-count" aria-live="polite">0</span>\n                                <span class="stat-label">Lokasi Dijelajahi</span>\n                            </div>\n                        </div>\n                    </div>\n                    <div class="banner-img">\n                        <div class="banner-overlay"></div>\n                    </div>\n                </section>\n\n                <section class="stories-grid-sec" aria-labelledby="stories-section-title">\n                    <div class="sec-hdr">\n                        <h2 id="stories-section-title">Cerita Terbaru</h2>\n                        <p id="stories-section-desc">Temukan inspirasi cerita di StoryHive</p>\n                    </div>\n\n                    <div class="srch-filter-bar">\n                        <div class="srch-box">\n                            <label for="search-input" class="srch-label is-visually-hidden">\n                                Cari cerita berdasarkan judul atau deskripsi\n                            </label>\n                            <input \n                                type="text" \n                                id="search-input" \n                                name="search"\n                                placeholder="Cari cerita berdasarkan judul atau deskripsi..." \n                                aria-label="Cari cerita berdasarkan judul atau deskripsi"\n                                aria-describedby="search-help"\n                            >\n                            <span class="srch-icon" aria-hidden="true">üîç</span>\n                        </div>\n                        <div class="flt-ctrl">\n                            <button id="filter-toggle" class="btn-filter" aria-expanded="false" aria-controls="filter-options">\n                                <span>Filter & Urutkan</span>\n                                <span class="filter-arrow" aria-hidden="true">‚ñº</span>\n                            </button>\n                            <div class="flt-opts is-hidden" id="filter-options" role="menu">\n                                <div class="flt-group">\n                                    <label for="sort-select">Urutkan Berdasarkan:</label>\n                                    <select id="sort-select" aria-describedby="sort-help">\n                                        <option value="newest">Terbaru</option>\n                                        <option value="oldest">Terlama</option>\n                                        <option value="name">Nama A-Z</option>\n                                    </select>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n\n                    <div class="stories-grid-cntnr">\n                        <div id="loading-indicator" class="is-loading" role="status" aria-live="polite">\n                            <div class="loading-spinner" aria-hidden="true"></div>\n                            <p>Memuat cerita...</p>\n                        </div>\n                        \n                        <div id="error-message" class="error-msg is-hidden" role="alert" aria-live="assertive"></div>\n                        \n                        <div class="stories-grid" id="stories-grid" aria-live="polite">\n                        </div>\n\n                        <div class="no-s is-hidden" id="no-stories" role="status" aria-live="polite">\n                            <div class="no-s-cnt">\n                                <div class="no-s-icon" aria-hidden="true">üìù</div>\n                                <h3>Belum Ada Cerita</h3>\n                                <p>Jadilah yang pertama membagikan pengalaman menarik Anda</p>\n                                <a href="#/add-s" class="btn-primary" aria-label="Bagikan cerita pertama Anda">Bagikan Cerita Pertama</a>\n                            </div>\n                        </div>\n                    </div>\n                </section>\n\n                <section class="map-full-sec" aria-labelledby="map-section-title">\n                    <div class="sec-hdr">\n                        <h2 id="map-section-title">Peta Lokasi Cerita</h2>\n                        <p id="map-section-desc">Jelajahi cerita berdasarkan lokasi di peta interaktif</p>\n                    </div>\n                    \n                    <div class="map-full-cntnr">\n                        <div id="map" class="map-full" \n                             aria-label="Peta digital menampilkan lokasi cerita"\n                             role="application"\n                             tabindex="0">\n                        </div>\n                        <div class="map-ctrl">\n                            <button id="locate-btn" class="map-btn" \n                                    aria-label="Gunakan lokasi saya saat ini" \n                                    title="Lokasi Saya">\n                                üìç\n                            </button>\n                            <button id="zoom-in-btn" class="map-btn" \n                                    aria-label="Perbesar peta" \n                                    title="Perbesar">\n                                +\n                            </button>\n                            <button id="zoom-out-btn" class="map-btn" \n                                    aria-label="Perkecil peta" \n                                    title="Perkecil">\n                                -\n                            </button>\n                        </div>\n                        <div class="map-info">\n                            <p>Klik pada marker di peta untuk melihat detail cerita</p>\n                        </div>\n                    </div>\n                </section>\n            </div>\n        ',t}},{key:"init",value:(h=k(u().mark((function t(){return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.loadStories();case 3:return t.next=5,this.initializeMap();case 5:this.setupEventHandlers(),this.updateStats(),t.next=13;break;case 9:return t.prev=9,t.t0=t.catch(0),t.next=13,this.handleLoadError(t.t0);case 13:case"end":return t.stop()}}),t,this,[[0,9]])}))),function(){return h.apply(this,arguments)})},{key:"initializeMap",value:(f=k(u().mark((function t(){var e=this;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,new Promise((function(t){return setTimeout(t,100)}));case 2:this.mapManager=new r.A("map",{center:[-6.2088,106.8456],zoom:10}),this.setupMapControls(),this.filteredStories.forEach((function(t){t.lat&&t.lon&&e.mapManager.addMarker(t,{onClick:function(t){e.navigateToStoryDetail(t.id)}})}));case 5:case"end":return t.stop()}}),t,this)}))),function(){return f.apply(this,arguments)})},{key:"setupMapControls",value:function(){var t=this,e=this.element.querySelector("#locate-btn"),n=this.element.querySelector("#zoom-in-btn"),r=this.element.querySelector("#zoom-out-btn");e.addEventListener("click",(function(){navigator.geolocation&&navigator.geolocation.getCurrentPosition((function(e){var n=e.coords,r=n.latitude,a=n.longitude;t.mapManager.setView(r,a,15)}),(function(e){t.showAlert("Error","Tidak dapat mengakses lokasi Anda.")}))})),n.addEventListener("click",(function(){t.mapManager.map.zoomIn()})),r.addEventListener("click",(function(){t.mapManager.map.zoomOut()}))}},{key:"loadStories",value:(p=k(u().mark((function t(){return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.showLoading(),t.prev=1,t.next=4,a.default.getStories();case 4:return this.stories=t.sent,this.filteredStories=s(this.stories),t.next=8,this.loadAllFavStatus();case 8:this.displayStories(),t.next=15;break;case 11:return t.prev=11,t.t0=t.catch(1),t.next=15,this.handleLoadError(t.t0);case 15:case"end":return t.stop()}}),t,this,[[1,11]])}))),function(){return p.apply(this,arguments)})},{key:"loadAllFavStatus",value:(d=k(u().mark((function t(){var e,n,r;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.favStatus={},e=o(this.stories),t.prev=2,e.s();case 4:if((n=e.n()).done){t.next=18;break}return r=n.value,t.prev=6,t.next=9,this.isStoryFav(r.id);case 9:this.favStatus[r.id]=t.sent,t.next=16;break;case 12:t.prev=12,t.t0=t.catch(6),console.error("Error loading fav status for ".concat(r.id,":"),t.t0),this.favStatus[r.id]=!1;case 16:t.next=4;break;case 18:t.next=23;break;case 20:t.prev=20,t.t1=t.catch(2),e.e(t.t1);case 23:return t.prev=23,e.f(),t.finish(23);case 26:case"end":return t.stop()}}),t,this,[[2,20,23,26],[6,12]])}))),function(){return d.apply(this,arguments)})},{key:"updateStats",value:function(){var t=this.element.querySelector("#stories-count"),e=this.element.querySelector("#locations-count");if(t&&(t.textContent=this.stories.length),e){var n=new Set(this.stories.filter((function(t){return t.lat&&t.lon})).map((function(t){return"".concat(t.lat,",").concat(t.lon)}))).size;e.textContent=n}}},{key:"handleLoadError",value:(l=k(u().mark((function t(e){var n;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n="Gagal memuat cerita. ",e.message.includes("network")||!navigator.onLine?n="Koneksi internet bermasalah. Silakan periksa koneksi Anda.":e.message.includes("token")||e.message.includes("auth")?(n="Sesi Anda telah berakhir. Silakan login kembali.",setTimeout((function(){window.location.hash="#/auth"}),2e3)):n=e.message||"Terjadi kesalahan yang tidak diketahui.",this.showError(n),t.next=5,this.showAlert("Gagal Memuat Cerita",n,"error");case 5:case"end":return t.stop()}}),t,this)}))),function(t){return l.apply(this,arguments)})},{key:"showError",value:function(t){var e=this.element.querySelector("#loading-indicator"),n=this.element.querySelector("#stories-grid"),r=this.element.querySelector("#error-message");e.classList.add("is-hidden"),n.innerHTML="",r.textContent=t,r.classList.remove("is-hidden")}},{key:"showLoading",value:function(){var t=this.element.querySelector("#loading-indicator"),e=this.element.querySelector("#stories-grid"),n=this.element.querySelector("#error-message"),r=this.element.querySelector("#no-stories");t.classList.remove("is-hidden"),e.innerHTML="",n.classList.add("is-hidden"),r.classList.add("is-hidden")}},{key:"showAlert",value:(c=k(u().mark((function t(e,n){var r,a=arguments;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=a.length>2&&void 0!==a[2]?a[2]:"error","undefined"==typeof Swal){t.next=12;break}return t.prev=2,t.next=5,Swal.fire({icon:r,title:e,text:n,confirmButtonText:"OK",confirmButtonColor:"error"===r?"#dc2626":"#2563eb"});case 5:t.next=10;break;case 7:t.prev=7,t.t0=t.catch(2),alert("".concat(e,": ").concat(n));case 10:t.next=13;break;case 12:alert("".concat(e,": ").concat(n));case 13:case"end":return t.stop()}}),t,null,[[2,7]])}))),function(t,e){return c.apply(this,arguments)})},{key:"displayStories",value:function(){var t=this,e=this.element.querySelector("#stories-grid"),n=this.element.querySelector("#loading-indicator"),r=this.element.querySelector("#error-message"),a=this.element.querySelector("#no-stories");if(n.classList.add("is-hidden"),r.classList.add("is-hidden"),0===this.filteredStories.length)return e.innerHTML="",void a.classList.remove("is-hidden");a.classList.add("is-hidden"),e.innerHTML=this.filteredStories.map((function(e){var n=t.favStatus[e.id]||!1;return'\n            <article class="s-card" data-story-id="'.concat(e.id,'" aria-labelledby="story-title-').concat(e.id,'">\n                <div class="s-img">\n                    <img \n                        src="').concat(e.photoUrl,'" \n                        alt="').concat(e.description,'" \n                        loading="lazy"\n                    >\n                    <div class="s-overlay">\n                        <button class="btn-detail" data-story-id="').concat(e.id,'" aria-label="Lihat detail cerita ').concat(e.name,'">\n                            Lihat Detail\n                        </button>\n                        <button class="btn-fav ').concat(n?"is-fav":"",'" \n                                data-story-id="').concat(e.id,'"\n                                aria-label="').concat(n?"Hapus dari favorit":"Tambah ke favorit",'">\n                            ').concat(n?"‚ù§Ô∏è":"ü§ç",'\n                        </button>\n                    </div>\n                </div>\n                <div class="s-cnt">\n                    <h3 id="story-title-').concat(e.id,'" class="s-title">').concat(e.name,'</h3>\n                    <p class="s-desc">').concat(t.truncateDescription(e.description),'</p>\n                    <div class="s-meta">\n                        <span class="s-date">\n                            ').concat(new Date(e.createdAt).toLocaleDateString("id-ID",{day:"numeric",month:"long",year:"numeric"}),"\n                        </span>\n                        ").concat(e.lat&&e.lon?'\n                            <button class="btn-location" data-story-id="'.concat(e.id,'" \n                                    aria-label="Lihat lokasi cerita ').concat(e.name,' di peta" \n                                    title="Lihat di peta">\n                                üìç\n                            </button>\n                        '):"","\n                    </div>\n                </div>\n            </article>\n            ")})).join("")}},{key:"truncateDescription",value:function(t){return t.length>120?t.substring(0,120)+"...":t}},{key:"setupEventHandlers",value:function(){var t,e=this;this.element.addEventListener("click",function(){var t=k(u().mark((function t(n){var r,a,i,o,s,c,l,d;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(r=n.target.closest(".btn-detail"))){t.next=5;break}return a=r.dataset.storyId,e.navigateToStoryDetail(a),t.abrupt("return");case 5:if(!(i=n.target.closest(".btn-fav"))){t.next=11;break}return o=i.dataset.storyId,t.next=10,e.toggleFav(o);case 10:return t.abrupt("return");case 11:if(!(s=n.target.closest(".btn-location"))){t.next=16;break}return c=s.dataset.storyId,e.focusOnStoryMap(c),t.abrupt("return");case 16:!(l=n.target.closest(".s-card"))||n.target.closest(".btn-detail")||n.target.closest(".btn-fav")||n.target.closest(".btn-location")||(d=l.dataset.storyId,e.navigateToStoryDetail(d));case 18:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),this.element.querySelector("#search-input").addEventListener("input",(function(n){clearTimeout(t),t=setTimeout((function(){e.handleSearch(n.target.value)}),300)}));var n=this.element.querySelector("#filter-toggle"),r=this.element.querySelector("#filter-options");n.addEventListener("click",(function(){var t="true"===n.getAttribute("aria-expanded");n.setAttribute("aria-expanded",!t),r.classList.toggle("is-hidden")})),this.element.querySelector("#sort-select").addEventListener("change",(function(t){e.handleSort(t.target.value)})),document.addEventListener("click",(function(t){t.target.closest(".flt-ctrl")||(r.classList.add("is-hidden"),n.setAttribute("aria-expanded","false"))}))}},{key:"isStoryFav",value:(i=k(u().mark((function t(e){return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,"undefined"==typeof app||"function"!=typeof app.isStoryFav){t.next=5;break}return t.next=4,app.isStoryFav(e);case 4:return t.abrupt("return",t.sent);case 5:return t.abrupt("return",!1);case 8:return t.prev=8,t.t0=t.catch(0),console.error("Error checking fav status:",t.t0),t.abrupt("return",!1);case 12:case"end":return t.stop()}}),t,null,[[0,8]])}))),function(t){return i.apply(this,arguments)})},{key:"toggleFav",value:(n=k(u().mark((function t(e){var n,r;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,n=this.filteredStories.find((function(t){return t.id===e}))){t.next=4;break}return t.abrupt("return");case 4:if(!(r=this.favStatus[e]||!1)){t.next=11;break}return t.next=8,app.removeFromFav(e);case 8:this.favStatus[e]=!1,t.next=14;break;case 11:return t.next=13,app.addToFav(n);case 13:this.favStatus[e]=!0;case 14:this.updateFavButton(e,!r),t.next=21;break;case 17:t.prev=17,t.t0=t.catch(0),console.error("Error toggling favorite:",t.t0),this.showAlert("Error","Gagal mengubah status favorit","error");case 21:case"end":return t.stop()}}),t,this,[[0,17]])}))),function(t){return n.apply(this,arguments)})},{key:"updateFavButton",value:function(t,e){var n=this.element.querySelector('.btn-fav[data-story-id="'.concat(t,'"]'));n&&(n.classList.toggle("is-fav",e),n.innerHTML=e?"‚ù§Ô∏è":"ü§ç",n.setAttribute("aria-label",e?"Hapus dari favorit":"Tambah ke favorit"))}},{key:"navigateToStoryDetail",value:function(t){a.default.isLoggedIn()?window.location.hash="#/s/".concat(t):"undefined"!=typeof Swal?Swal.fire({icon:"warning",title:"Login Diperlukan",text:"Anda harus login terlebih dahulu untuk melihat detail cerita.",confirmButtonText:"Login",confirmButtonColor:"#2563eb",showCancelButton:!0,cancelButtonText:"Batal"}).then((function(t){t.isConfirmed&&(window.location.hash="#/auth")})):confirm("Anda harus login terlebih dahulu untuk melihat detail cerita. Login sekarang?")&&(window.location.hash="#/auth")}},{key:"focusOnStoryMap",value:function(t){var e=this.filteredStories.find((function(e){return e.id===t}));e&&e.lat&&e.lon&&this.mapManager&&(this.mapManager.setView(e.lat,e.lon,15),this.mapManager.setActiveMarker(t),this.element.querySelector(".map-full-sec").scrollIntoView({behavior:"smooth"}))}},{key:"handleSearch",value:function(t){if(t.trim()){var e=t.toLowerCase();this.filteredStories=this.stories.filter((function(t){return t.name.toLowerCase().includes(e)||t.description.toLowerCase().includes(e)}))}else this.filteredStories=s(this.stories);this.displayStories(),this.updateMapMarkers()}},{key:"handleSort",value:function(t){this.filteredStories.sort((function(e,n){switch(t){case"newest":return new Date(n.createdAt)-new Date(e.createdAt);case"oldest":return new Date(e.createdAt)-new Date(n.createdAt);case"name":return e.name.localeCompare(n.name);default:return 0}})),this.displayStories()}},{key:"updateMapMarkers",value:function(){var t=this;this.mapManager&&(this.mapManager.clearMarkers(),this.filteredStories.forEach((function(e){e.lat&&e.lon&&t.mapManager.addMarker(e,{onClick:function(e){t.navigateToStoryDetail(e.id)}})})))}},{key:"destroy",value:function(){this.mapManager&&(this.mapManager.destroy(),this.mapManager=null)}}],e&&S(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,n,i,c,l,d,p,f,h}()}}]);