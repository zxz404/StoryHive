/*! For license information please see app.bundle.js.LICENSE.txt */
(()=>{"use strict";var t,e,n={56:(t,e,n)=>{t.exports=function(t){var e=n.nc;e&&t.setAttribute("nonce",e)}},72:t=>{var e=[];function n(t){for(var n=-1,r=0;r<e.length;r++)if(e[r].identifier===t){n=r;break}return n}function r(t,r){for(var i={},a=[],s=0;s<t.length;s++){var c=t[s],u=r.base?c[0]+r.base:c[0],f=i[u]||0,l="".concat(u," ").concat(f);i[u]=f+1;var p=n(l),d={css:c[1],media:c[2],sourceMap:c[3],supports:c[4],layer:c[5]};if(-1!==p)e[p].references++,e[p].updater(d);else{var h=o(d,r);r.byIndex=s,e.splice(s,0,{identifier:l,updater:h,references:1})}a.push(l)}return a}function o(t,e){var n=e.domAPI(e);return n.update(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap&&e.supports===t.supports&&e.layer===t.layer)return;n.update(t=e)}else n.remove()}}t.exports=function(t,o){var i=r(t=t||[],o=o||{});return function(t){t=t||[];for(var a=0;a<i.length;a++){var s=n(i[a]);e[s].references--}for(var c=r(t,o),u=0;u<i.length;u++){var f=n(i[u]);0===e[f].references&&(e[f].updater(),e.splice(f,1))}i=c}}},113:t=>{t.exports=function(t,e){if(e.styleSheet)e.styleSheet.cssText=t;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(t))}}},177:(t,e,n)=>{n.d(e,{A:()=>s});var r=n(601),o=n.n(r),i=n(314),a=n.n(i)()(o());a.push([t.id,"// extracted by mini-css-extract-plugin\nexport {};",""]);const s=a},314:t=>{t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var n="",r=void 0!==e[5];return e[4]&&(n+="@supports (".concat(e[4],") {")),e[2]&&(n+="@media ".concat(e[2]," {")),r&&(n+="@layer".concat(e[5].length>0?" ".concat(e[5]):""," {")),n+=t(e),r&&(n+="}"),e[2]&&(n+="}"),e[4]&&(n+="}"),n})).join("")},e.i=function(t,n,r,o,i){"string"==typeof t&&(t=[[null,t,void 0]]);var a={};if(r)for(var s=0;s<this.length;s++){var c=this[s][0];null!=c&&(a[c]=!0)}for(var u=0;u<t.length;u++){var f=[].concat(t[u]);r&&a[f[0]]||(void 0!==i&&(void 0===f[5]||(f[1]="@layer".concat(f[5].length>0?" ".concat(f[5]):""," {").concat(f[1],"}")),f[5]=i),n&&(f[2]?(f[1]="@media ".concat(f[2]," {").concat(f[1],"}"),f[2]=n):f[2]=n),o&&(f[4]?(f[1]="@supports (".concat(f[4],") {").concat(f[1],"}"),f[4]=o):f[4]="".concat(o)),e.push(f))}},e}},330:(t,e,n)=>{function r(t){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r(t)}function o(t){return function(t){if(Array.isArray(t))return i(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return i(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?i(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function a(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function s(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?a(Object(n),!0).forEach((function(e){c(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function c(t,e,n){return(e=k(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function u(){var t=v(),e=t.m(u),n=(Object.getPrototypeOf?Object.getPrototypeOf(e):e.__proto__).constructor;function r(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===n||"GeneratorFunction"===(e.displayName||e.name))}var o={throw:1,return:2,break:3,continue:3};function i(t){var e,n;return function(r){e||(e={stop:function(){return n(r.a,2)},catch:function(){return r.v},abrupt:function(t,e){return n(r.a,o[t],e)},delegateYield:function(t,o,i){return e.resultName=o,n(r.d,f(t),i)},finish:function(t){return n(r.f,t)}},n=function(t,n,o){r.p=e.prev,r.n=e.next;try{return t(n,o)}finally{e.next=r.n}}),e.resultName&&(e[e.resultName]=r.v,e.resultName=void 0),e.sent=r.v,e.next=r.n;try{return t.call(this,e)}finally{r.p=e.prev,r.n=e.next}}}return(u=function(){return{wrap:function(e,n,r,o){return t.w(i(e),n,r,o&&o.reverse())},isGeneratorFunction:r,mark:t.m,awrap:function(t,e){return new b(t,e)},AsyncIterator:h,async:function(t,e,n,o,a){return(r(e)?d:p)(i(t),e,n,o,a)},keys:l,values:f}})()}function f(t){if(null!=t){var e=t["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],n=0;if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length))return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}}throw new TypeError(r(t)+" is not iterable")}function l(t){var e=Object(t),n=[];for(var r in e)n.unshift(r);return function t(){for(;n.length;)if((r=n.pop())in e)return t.value=r,t.done=!1,t;return t.done=!0,t}}function p(t,e,n,r,o){var i=d(t,e,n,r,o);return i.next().then((function(t){return t.done?t.value:i.next()}))}function d(t,e,n,r,o){return new h(v().w(t,e,n,r),o||Promise)}function h(t,e){function n(r,o,i,a){try{var s=t[r](o),c=s.value;return c instanceof b?e.resolve(c.v).then((function(t){n("next",t,i,a)}),(function(t){n("throw",t,i,a)})):e.resolve(c).then((function(t){s.value=t,i(s)}),(function(t){return n("throw",t,i,a)}))}catch(t){a(t)}}var r;this.next||(y(h.prototype),y(h.prototype,"function"==typeof Symbol&&Symbol.asyncIterator||"@asyncIterator",(function(){return this}))),y(this,"_invoke",(function(t,o,i){function a(){return new e((function(e,r){n(t,i,e,r)}))}return r=r?r.then(a,a):a()}),!0)}function v(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var c=r&&r.prototype instanceof s?r:s,u=Object.create(c.prototype);return y(u,"_invoke",function(n,r,o){var i,s,c,u=0,f=o||[],l=!1,p={p:0,n:0,v:t,a:d,f:d.bind(t,4),d:function(e,n){return i=e,s=0,c=t,p.n=n,a}};function d(n,r){for(s=n,c=r,e=0;!l&&u&&!o&&e<f.length;e++){var o,i=f[e],d=p.p,h=i[2];n>3?(o=h===r)&&(c=i[(s=i[4])?5:(s=3,3)],i[4]=i[5]=t):i[0]<=d&&((o=n<2&&d<i[1])?(s=0,p.v=r,p.n=i[1]):d<h&&(o=n<3||i[0]>r||r>h)&&(i[4]=n,i[5]=r,p.n=h,s=0))}if(o||n>1)return a;throw l=!0,r}return function(o,f,h){if(u>1)throw TypeError("Generator is already running");for(l&&1===f&&d(f,h),s=f,c=h;(e=s<2?t:c)||!l;){i||(s?s<3?(s>1&&(p.n=-1),d(s,c)):p.n=c:p.v=c);try{if(u=2,i){if(s||(o="next"),e=i[o]){if(!(e=e.call(i,c)))throw TypeError("iterator result is not an object");if(!e.done)return e;c=e.value,s<2&&(s=0)}else 1===s&&(e=i.return)&&e.call(i),s<2&&(c=TypeError("The iterator does not provide a '"+o+"' method"),s=1);i=t}else if((e=(l=p.n<0)?c:n.call(r,p))!==a)break}catch(e){i=t,s=1,c=e}finally{u=1}}return{value:e,done:l}}}(n,o,i),!0),u}var a={};function s(){}function c(){}function u(){}e=Object.getPrototypeOf;var f=[][r]?e(e([][r]())):(y(e={},r,(function(){return this})),e),l=u.prototype=s.prototype=Object.create(f);function p(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,u):(t.__proto__=u,y(t,o,"GeneratorFunction")),t.prototype=Object.create(l),t}return c.prototype=u,y(l,"constructor",u),y(u,"constructor",c),c.displayName="GeneratorFunction",y(u,o,"GeneratorFunction"),y(l),y(l,o,"Generator"),y(l,r,(function(){return this})),y(l,"toString",(function(){return"[object Generator]"})),(v=function(){return{w:i,m:p}})()}function y(t,e,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}y=function(t,e,n,r){function i(e,n){y(t,e,(function(t){return this._invoke(e,n,t)}))}e?o?o(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n:(i("next",0),i("throw",1),i("return",2))},y(t,e,n,r)}function b(t,e){this.v=t,this.k=e}function g(t,e,n,r,o,i,a){try{var s=t[i](a),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(r,o)}function m(t){return function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function a(t){g(i,r,o,a,s,"next",t)}function s(t){g(i,r,o,a,s,"throw",t)}a(void 0)}))}}function w(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,k(r.key),r)}}function k(t){var e=function(t){if("object"!=r(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=r(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==r(e)?e:e+""}n.d(e,{U:()=>S});var x="favStories",S=new(function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.db=null,this.init()},e=[{key:"init",value:(h=m(u().mark((function t(){var e=this;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t,n){var r=indexedDB.open("StoryHiveDB",1);r.onerror=function(){return n(r.error)},r.onsuccess=function(){e.db=r.result,t(e.db)},r.onupgradeneeded=function(t){var e=t.target.result;if(!e.objectStoreNames.contains(x)){var n=e.createObjectStore(x,{keyPath:"id",autoIncrement:!1});n.createIndex("createdAt","createdAt",{unique:!1}),n.createIndex("owner","owner.name",{unique:!1}),n.createIndex("isSynced","isSynced",{unique:!1})}}})));case 1:case"end":return t.stop()}}),t)}))),function(){return h.apply(this,arguments)})},{key:"addFav",value:(d=m(u().mark((function t(e){var n=this;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.db){t.next=3;break}return t.next=3,this.init();case 3:return t.abrupt("return",new Promise((function(t,r){var o=n.db.transaction([x],"readwrite").objectStore(x),i=s(s({},e),{},{id:e.id,isFav:!0,createdAt:(new Date).toISOString(),isSynced:!0}),a=o.add(i);a.onsuccess=function(){return t(i)},a.onerror=function(){return r(a.error)}})));case 4:case"end":return t.stop()}}),t,this)}))),function(t){return d.apply(this,arguments)})},{key:"addOffStory",value:(p=m(u().mark((function t(e,n){var r=this;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.db){t.next=3;break}return t.next=3,this.init();case 3:return t.abrupt("return",new Promise((function(t,o){var i=r.db.transaction([x],"readwrite").objectStore(x),a=s(s({},e),{},{id:"off_".concat(Date.now()),isFav:!1,createdAt:(new Date).toISOString(),isSynced:!1,pendingSync:!0,token:n,localData:e}),c=i.add(a);c.onsuccess=function(){return t(a)},c.onerror=function(){return o(c.error)}})));case 4:case"end":return t.stop()}}),t,this)}))),function(t,e){return p.apply(this,arguments)})},{key:"getAllFav",value:(l=m(u().mark((function t(){var e=this;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.db){t.next=3;break}return t.next=3,this.init();case 3:return t.abrupt("return",new Promise((function(t,n){var r=e.db.transaction([x],"readonly").objectStore(x).getAll();r.onsuccess=function(){return t(r.result)},r.onerror=function(){return n(r.error)}})));case 4:case"end":return t.stop()}}),t,this)}))),function(){return l.apply(this,arguments)})},{key:"getFav",value:(f=m(u().mark((function t(){var e,n,r,o,i,a,s,c,f,l,p,d,h=arguments;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=(e=h.length>0&&void 0!==h[0]?h[0]:{}).srch,r=void 0===n?"":n,o=e.sort,i=void 0===o?"createdAt":o,a=e.order,s=void 0===a?"desc":a,c=e.owner,f=void 0===c?"":c,t.next=3,this.getAllFav();case 3:return l=t.sent,p=l.filter((function(t){return t.isFav})),r&&(d=r.toLowerCase(),p=p.filter((function(t){var e,n;return(null===(e=t.name)||void 0===e?void 0:e.toLowerCase().includes(d))||(null===(n=t.description)||void 0===n?void 0:n.toLowerCase().includes(d))}))),f&&(p=p.filter((function(t){var e;return(null===(e=t.owner)||void 0===e?void 0:e.name)===f}))),p.sort((function(t,e){var n=t[i],r=e[i];return"createdAt"===i&&(n=new Date(n),r=new Date(r)),"asc"===s?n>r?1:-1:n<r?1:-1})),t.abrupt("return",p);case 9:case"end":return t.stop()}}),t,this)}))),function(){return f.apply(this,arguments)})},{key:"getPendingSync",value:(c=m(u().mark((function t(){var e;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.getAllFav();case 2:return e=t.sent,t.abrupt("return",e.filter((function(t){return t.pendingSync&&!t.isSynced})));case 4:case"end":return t.stop()}}),t,this)}))),function(){return c.apply(this,arguments)})},{key:"rmvFav",value:(a=m(u().mark((function t(e){var n=this;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.db){t.next=3;break}return t.next=3,this.init();case 3:return t.abrupt("return",new Promise((function(t,r){var o=n.db.transaction([x],"readwrite").objectStore(x).delete(e);o.onsuccess=function(){return t(e)},o.onerror=function(){return r(o.error)}})));case 4:case"end":return t.stop()}}),t,this)}))),function(t){return a.apply(this,arguments)})},{key:"markSynced",value:(i=m(u().mark((function t(e){var n=this;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.db){t.next=3;break}return t.next=3,this.init();case 3:return t.abrupt("return",new Promise(function(){var t=m(u().mark((function t(r,o){var i,a,s;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:i=n.db.transaction([x],"readwrite"),a=i.objectStore(x),(s=a.get(e)).onsuccess=function(){var t=s.result;if(t){t.isSynced=!0,t.pendingSync=!1,t.syncedAt=(new Date).toISOString();var e=a.put(t);e.onsuccess=function(){return r(t)},e.onerror=function(){return o(e.error)}}else o(new Error("Story not found"))},s.onerror=function(){return o(s.error)};case 5:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()));case 4:case"end":return t.stop()}}),t,this)}))),function(t){return i.apply(this,arguments)})},{key:"getUniqOwners",value:(r=m(u().mark((function t(){var e,n;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.getAllFav();case 2:return e=t.sent,n=e.filter((function(t){return t.isFav&&t.owner})).map((function(t){return t.owner.name})),t.abrupt("return",o(new Set(n)));case 5:case"end":return t.stop()}}),t,this)}))),function(){return r.apply(this,arguments)})},{key:"isFav",value:(n=m(u().mark((function t(e){var n=this;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.db){t.next=3;break}return t.next=3,this.init();case 3:return t.abrupt("return",new Promise((function(t,r){var o=n.db.transaction([x],"readonly").objectStore(x).get(e);o.onsuccess=function(){var e=o.result;t(e&&e.isFav)},o.onerror=function(){return r(o.error)}})));case 4:case"end":return t.stop()}}),t,this)}))),function(t){return n.apply(this,arguments)})}],e&&w(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,n,r,i,a,c,f,l,p,d,h}())},540:t=>{t.exports=function(t){var e=document.createElement("style");return t.setAttributes(e,t.attributes),t.insert(e,t.options),e}},601:t=>{t.exports=function(t){return t[1]}},659:t=>{var e={};t.exports=function(t,n){var r=function(t){if(void 0===e[t]){var n=document.querySelector(t);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(t){n=null}e[t]=n}return e[t]}(t);if(!r)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");r.appendChild(n)}},775:(t,e,n)=>{function r(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function o(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?r(Object(n),!0).forEach((function(e){i(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function i(t,e,n){return(e=m(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function a(t){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},a(t)}function s(){var t=d(),e=t.m(s),n=(Object.getPrototypeOf?Object.getPrototypeOf(e):e.__proto__).constructor;function r(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===n||"GeneratorFunction"===(e.displayName||e.name))}var o={throw:1,return:2,break:3,continue:3};function i(t){var e,n;return function(r){e||(e={stop:function(){return n(r.a,2)},catch:function(){return r.v},abrupt:function(t,e){return n(r.a,o[t],e)},delegateYield:function(t,o,i){return e.resultName=o,n(r.d,c(t),i)},finish:function(t){return n(r.f,t)}},n=function(t,n,o){r.p=e.prev,r.n=e.next;try{return t(n,o)}finally{e.next=r.n}}),e.resultName&&(e[e.resultName]=r.v,e.resultName=void 0),e.sent=r.v,e.next=r.n;try{return t.call(this,e)}finally{r.p=e.prev,r.n=e.next}}}return(s=function(){return{wrap:function(e,n,r,o){return t.w(i(e),n,r,o&&o.reverse())},isGeneratorFunction:r,mark:t.m,awrap:function(t,e){return new v(t,e)},AsyncIterator:p,async:function(t,e,n,o,a){return(r(e)?l:f)(i(t),e,n,o,a)},keys:u,values:c}})()}function c(t){if(null!=t){var e=t["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],n=0;if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length))return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}}throw new TypeError(a(t)+" is not iterable")}function u(t){var e=Object(t),n=[];for(var r in e)n.unshift(r);return function t(){for(;n.length;)if((r=n.pop())in e)return t.value=r,t.done=!1,t;return t.done=!0,t}}function f(t,e,n,r,o){var i=l(t,e,n,r,o);return i.next().then((function(t){return t.done?t.value:i.next()}))}function l(t,e,n,r,o){return new p(d().w(t,e,n,r),o||Promise)}function p(t,e){function n(r,o,i,a){try{var s=t[r](o),c=s.value;return c instanceof v?e.resolve(c.v).then((function(t){n("next",t,i,a)}),(function(t){n("throw",t,i,a)})):e.resolve(c).then((function(t){s.value=t,i(s)}),(function(t){return n("throw",t,i,a)}))}catch(t){a(t)}}var r;this.next||(h(p.prototype),h(p.prototype,"function"==typeof Symbol&&Symbol.asyncIterator||"@asyncIterator",(function(){return this}))),h(this,"_invoke",(function(t,o,i){function a(){return new e((function(e,r){n(t,i,e,r)}))}return r=r?r.then(a,a):a()}),!0)}function d(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var c=r&&r.prototype instanceof s?r:s,u=Object.create(c.prototype);return h(u,"_invoke",function(n,r,o){var i,s,c,u=0,f=o||[],l=!1,p={p:0,n:0,v:t,a:d,f:d.bind(t,4),d:function(e,n){return i=e,s=0,c=t,p.n=n,a}};function d(n,r){for(s=n,c=r,e=0;!l&&u&&!o&&e<f.length;e++){var o,i=f[e],d=p.p,h=i[2];n>3?(o=h===r)&&(c=i[(s=i[4])?5:(s=3,3)],i[4]=i[5]=t):i[0]<=d&&((o=n<2&&d<i[1])?(s=0,p.v=r,p.n=i[1]):d<h&&(o=n<3||i[0]>r||r>h)&&(i[4]=n,i[5]=r,p.n=h,s=0))}if(o||n>1)return a;throw l=!0,r}return function(o,f,h){if(u>1)throw TypeError("Generator is already running");for(l&&1===f&&d(f,h),s=f,c=h;(e=s<2?t:c)||!l;){i||(s?s<3?(s>1&&(p.n=-1),d(s,c)):p.n=c:p.v=c);try{if(u=2,i){if(s||(o="next"),e=i[o]){if(!(e=e.call(i,c)))throw TypeError("iterator result is not an object");if(!e.done)return e;c=e.value,s<2&&(s=0)}else 1===s&&(e=i.return)&&e.call(i),s<2&&(c=TypeError("The iterator does not provide a '"+o+"' method"),s=1);i=t}else if((e=(l=p.n<0)?c:n.call(r,p))!==a)break}catch(e){i=t,s=1,c=e}finally{u=1}}return{value:e,done:l}}}(n,o,i),!0),u}var a={};function s(){}function c(){}function u(){}e=Object.getPrototypeOf;var f=[][r]?e(e([][r]())):(h(e={},r,(function(){return this})),e),l=u.prototype=s.prototype=Object.create(f);function p(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,u):(t.__proto__=u,h(t,o,"GeneratorFunction")),t.prototype=Object.create(l),t}return c.prototype=u,h(l,"constructor",u),h(u,"constructor",c),c.displayName="GeneratorFunction",h(u,o,"GeneratorFunction"),h(l),h(l,o,"Generator"),h(l,r,(function(){return this})),h(l,"toString",(function(){return"[object Generator]"})),(d=function(){return{w:i,m:p}})()}function h(t,e,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}h=function(t,e,n,r){function i(e,n){h(t,e,(function(t){return this._invoke(e,n,t)}))}e?o?o(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n:(i("next",0),i("throw",1),i("return",2))},h(t,e,n,r)}function v(t,e){this.v=t,this.k=e}function y(t,e,n,r,o,i,a){try{var s=t[i](a),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(r,o)}function b(t){return function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function a(t){y(i,r,o,a,s,"next",t)}function s(t){y(i,r,o,a,s,"throw",t)}a(void 0)}))}}function g(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,m(r.key),r)}}function m(t){var e=function(t){if("object"!=a(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=a(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==a(e)?e:e+""}n.r(e),n.d(e,{default:()=>A,deletePushSubscription:()=>N,getNotificationSettings:()=>P,getPushSubscriptions:()=>E,sendTestNotification:()=>S,subscribeToPushNotifications:()=>j,testPushNotification:()=>T,updateNotificationSettings:()=>O,updatePushSubscription:()=>x});var w="https://story-api.dicoding.dev/v1",k=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)},e=[{key:"register",value:(a=b(s().mark((function t(e){var n,r;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,fetch("".concat(w,"/register"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});case 3:return n=t.sent,t.next=6,n.json();case 6:if(r=t.sent,n.ok){t.next=9;break}throw new Error(r.message||"Failed to register");case 9:return t.abrupt("return",r);case 12:throw t.prev=12,t.t0=t.catch(0),console.error("Error registering:",t.t0),t.t0;case 16:case"end":return t.stop()}}),t,null,[[0,12]])}))),function(t){return a.apply(this,arguments)})},{key:"login",value:(i=b(s().mark((function t(e){var n,r;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,fetch("".concat(w,"/login"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});case 3:return n=t.sent,t.next=6,n.json();case 6:if(r=t.sent,n.ok){t.next=9;break}throw new Error(r.message||"Failed to login");case 9:return r.loginResult&&r.loginResult.token&&(localStorage.setItem("token",r.loginResult.token),localStorage.setItem("user",JSON.stringify(r.loginResult))),t.abrupt("return",r);case 13:throw t.prev=13,t.t0=t.catch(0),console.error("Error logging in:",t.t0),t.t0;case 17:case"end":return t.stop()}}),t,null,[[0,13]])}))),function(t){return i.apply(this,arguments)})},{key:"getStories",value:(o=b(s().mark((function t(){var e,n,r,o;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,e=localStorage.getItem("token"),n={},e&&(n.Authorization="Bearer ".concat(e)),t.next=6,fetch("".concat(w,"/stories"),{headers:n});case 6:return r=t.sent,t.next=9,r.json();case 9:if(o=t.sent,r.ok){t.next=12;break}throw new Error(o.message||"Failed to fetch stories");case 12:return t.abrupt("return",o.listStory||[]);case 15:throw t.prev=15,t.t0=t.catch(0),console.error("Error fetching stories:",t.t0),t.t0;case 19:case"end":return t.stop()}}),t,null,[[0,15]])}))),function(){return o.apply(this,arguments)})},{key:"addStory",value:(r=b(s().mark((function t(e){var n,r,o,i,a,c;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,n=localStorage.getItem("token"),(r=new FormData).append("description",e.description),r.append("photo",e.photo),e.lat&&r.append("lat",e.lat),e.lon&&r.append("lon",e.lon),o={},i="".concat(w,"/stories"),n?o.Authorization="Bearer ".concat(n):i="".concat(w,"/stories/guest"),t.next=12,fetch(i,{method:"POST",headers:o,body:r});case 12:return a=t.sent,t.next=15,a.json();case 15:if(c=t.sent,a.ok){t.next=18;break}throw new Error(c.message||"Failed to add story");case 18:return t.abrupt("return",c);case 21:throw t.prev=21,t.t0=t.catch(0),console.error("Error adding story:",t.t0),t.t0;case 25:case"end":return t.stop()}}),t,null,[[0,21]])}))),function(t){return r.apply(this,arguments)})},{key:"getStoryDetail",value:(n=b(s().mark((function t(e){var n,r,o,i;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,n=localStorage.getItem("token"),r={},n&&(r.Authorization="Bearer ".concat(n)),t.next=6,fetch("".concat(w,"/stories/").concat(e),{headers:r});case 6:return o=t.sent,t.next=9,o.json();case 9:if(i=t.sent,o.ok){t.next=12;break}throw new Error(i.message||"Failed to fetch story detail");case 12:return t.abrupt("return",i.story);case 15:throw t.prev=15,t.t0=t.catch(0),console.error("Error fetching story detail:",t.t0),t.t0;case 19:case"end":return t.stop()}}),t,null,[[0,15]])}))),function(t){return n.apply(this,arguments)})},{key:"logout",value:function(){localStorage.removeItem("token"),localStorage.removeItem("user")}},{key:"isLoggedIn",value:function(){return!!localStorage.getItem("token")}},{key:"getUser",value:function(){var t=localStorage.getItem("user");return t?JSON.parse(t):null}}],e&&g(t,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,n,r,o,i,a}(),x=function(){var t=b(s().mark((function t(e){var n,r,o,i=arguments;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=i.length>1&&void 0!==i[1]?i[1]:"subscribe",t.prev=1,console.log("Sending ".concat(n," request to server:"),e),t.next=5,fetch("".concat(w,"/push/subscriptions"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(localStorage.getItem("token"))},body:JSON.stringify({subscription:e,action:n,userAgent:navigator.userAgent,timestamp:(new Date).toISOString()})});case 5:if((r=t.sent).ok){t.next=12;break}return t.next=9,r.text();case 9:throw o=t.sent,console.error("Server returned ".concat(r.status,":"),o),new Error("Failed to ".concat(n," push subscription: ").concat(r.status));case 12:return console.log("".concat(n," request successful")),t.abrupt("return",r);case 16:if(t.prev=16,t.t0=t.catch(1),console.error("Error ".concat(n,"ing push subscription:"),t.t0),!t.t0.message.includes("Failed to fetch")){t.next=22;break}return console.log("Using fallback - simulating successful subscription"),t.abrupt("return",{ok:!0,status:200});case 22:throw t.t0;case 23:case"end":return t.stop()}}),t,null,[[1,16]])})));return function(e){return t.apply(this,arguments)}}(),S=function(){var t=b(s().mark((function t(e){var n,r;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,console.log("Sending test notification:",e),t.next=4,fetch("".concat(w,"/push/test"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(localStorage.getItem("token"))},body:JSON.stringify(o(o({},e),{},{timestamp:(new Date).toISOString(),userAgent:navigator.userAgent}))});case 4:if((n=t.sent).ok){t.next=11;break}return t.next=8,n.text();case 8:throw r=t.sent,console.error("Server returned ".concat(n.status,":"),r),new Error("Failed to send test notification: ".concat(n.status));case 11:return console.log("Test notification sent successfully"),t.abrupt("return",n);case 15:if(t.prev=15,t.t0=t.catch(0),console.error("Error sending test notification:",t.t0),!t.t0.message.includes("Failed to fetch")){t.next=21;break}return console.log("Using fallback - simulating successful test notification"),t.abrupt("return",{ok:!0,status:200});case 21:throw t.t0;case 22:case"end":return t.stop()}}),t,null,[[0,15]])})));return function(e){return t.apply(this,arguments)}}(),P=function(){var t=b(s().mark((function t(){var e;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,fetch("".concat(w,"/push/settings"),{headers:{Authorization:"Bearer ".concat(localStorage.getItem("token"))}});case 3:if((e=t.sent).ok){t.next=6;break}throw new Error("Failed to get notification settings: ".concat(e.status));case 6:return t.abrupt("return",e.json());case 9:return t.prev=9,t.t0=t.catch(0),console.error("Error getting notification settings:",t.t0),t.abrupt("return",{enabled:!0,types:{newStories:!0,storyLikes:!0,comments:!0,system:!0},frequency:"instant"});case 13:case"end":return t.stop()}}),t,null,[[0,9]])})));return function(){return t.apply(this,arguments)}}(),O=function(){var t=b(s().mark((function t(e){var n;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,fetch("".concat(w,"/push/settings"),{method:"PUT",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(localStorage.getItem("token"))},body:JSON.stringify(e)});case 3:if((n=t.sent).ok){t.next=6;break}throw new Error("Failed to update notification settings: ".concat(n.status));case 6:return t.abrupt("return",n.json());case 9:return t.prev=9,t.t0=t.catch(0),console.error("Error updating notification settings:",t.t0),t.abrupt("return",{success:!0,settings:e});case 13:case"end":return t.stop()}}),t,null,[[0,9]])})));return function(e){return t.apply(this,arguments)}}(),E=function(){var t=b(s().mark((function t(){var e;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,fetch("".concat(w,"/push/subscriptions"),{headers:{Authorization:"Bearer ".concat(localStorage.getItem("token"))}});case 3:if((e=t.sent).ok){t.next=6;break}throw new Error("Failed to get push subscriptions: ".concat(e.status));case 6:return t.abrupt("return",e.json());case 9:return t.prev=9,t.t0=t.catch(0),console.error("Error getting push subscriptions:",t.t0),t.abrupt("return",{subscriptions:[]});case 13:case"end":return t.stop()}}),t,null,[[0,9]])})));return function(){return t.apply(this,arguments)}}(),N=function(){var t=b(s().mark((function t(e){var n;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,fetch("".concat(w,"/push/subscriptions/").concat(e),{method:"DELETE",headers:{Authorization:"Bearer ".concat(localStorage.getItem("token"))}});case 3:if((n=t.sent).ok){t.next=6;break}throw new Error("Failed to delete push subscription: ".concat(n.status));case 6:return t.abrupt("return",n.json());case 9:return t.prev=9,t.t0=t.catch(0),console.error("Error deleting push subscription:",t.t0),t.abrupt("return",{success:!0});case 13:case"end":return t.stop()}}),t,null,[[0,9]])})));return function(e){return t.apply(this,arguments)}}(),j=function(){var t=b(s().mark((function t(e){return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",x(e,"subscribe"));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),T=function(){var t=b(s().mark((function t(e,n){return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",S({title:e,body:n,url:"#/home"}));case 1:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}();const A=k},805:(t,e,n)=>{n.d(e,{J:()=>w});var r=n(330);function o(t){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o(t)}function i(){var t=l(),e=t.m(i),n=(Object.getPrototypeOf?Object.getPrototypeOf(e):e.__proto__).constructor;function r(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===n||"GeneratorFunction"===(e.displayName||e.name))}var o={throw:1,return:2,break:3,continue:3};function p(t){var e,n;return function(r){e||(e={stop:function(){return n(r.a,2)},catch:function(){return r.v},abrupt:function(t,e){return n(r.a,o[t],e)},delegateYield:function(t,o,i){return e.resultName=o,n(r.d,a(t),i)},finish:function(t){return n(r.f,t)}},n=function(t,n,o){r.p=e.prev,r.n=e.next;try{return t(n,o)}finally{e.next=r.n}}),e.resultName&&(e[e.resultName]=r.v,e.resultName=void 0),e.sent=r.v,e.next=r.n;try{return t.call(this,e)}finally{r.p=e.prev,r.n=e.next}}}return(i=function(){return{wrap:function(e,n,r,o){return t.w(p(e),n,r,o&&o.reverse())},isGeneratorFunction:r,mark:t.m,awrap:function(t,e){return new d(t,e)},AsyncIterator:f,async:function(t,e,n,o,i){return(r(e)?u:c)(p(t),e,n,o,i)},keys:s,values:a}})()}function a(t){if(null!=t){var e=t["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],n=0;if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length))return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}}throw new TypeError(o(t)+" is not iterable")}function s(t){var e=Object(t),n=[];for(var r in e)n.unshift(r);return function t(){for(;n.length;)if((r=n.pop())in e)return t.value=r,t.done=!1,t;return t.done=!0,t}}function c(t,e,n,r,o){var i=u(t,e,n,r,o);return i.next().then((function(t){return t.done?t.value:i.next()}))}function u(t,e,n,r,o){return new f(l().w(t,e,n,r),o||Promise)}function f(t,e){function n(r,o,i,a){try{var s=t[r](o),c=s.value;return c instanceof d?e.resolve(c.v).then((function(t){n("next",t,i,a)}),(function(t){n("throw",t,i,a)})):e.resolve(c).then((function(t){s.value=t,i(s)}),(function(t){return n("throw",t,i,a)}))}catch(t){a(t)}}var r;this.next||(p(f.prototype),p(f.prototype,"function"==typeof Symbol&&Symbol.asyncIterator||"@asyncIterator",(function(){return this}))),p(this,"_invoke",(function(t,o,i){function a(){return new e((function(e,r){n(t,i,e,r)}))}return r=r?r.then(a,a):a()}),!0)}function l(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var c=r&&r.prototype instanceof s?r:s,u=Object.create(c.prototype);return p(u,"_invoke",function(n,r,o){var i,s,c,u=0,f=o||[],l=!1,p={p:0,n:0,v:t,a:d,f:d.bind(t,4),d:function(e,n){return i=e,s=0,c=t,p.n=n,a}};function d(n,r){for(s=n,c=r,e=0;!l&&u&&!o&&e<f.length;e++){var o,i=f[e],d=p.p,h=i[2];n>3?(o=h===r)&&(c=i[(s=i[4])?5:(s=3,3)],i[4]=i[5]=t):i[0]<=d&&((o=n<2&&d<i[1])?(s=0,p.v=r,p.n=i[1]):d<h&&(o=n<3||i[0]>r||r>h)&&(i[4]=n,i[5]=r,p.n=h,s=0))}if(o||n>1)return a;throw l=!0,r}return function(o,f,h){if(u>1)throw TypeError("Generator is already running");for(l&&1===f&&d(f,h),s=f,c=h;(e=s<2?t:c)||!l;){i||(s?s<3?(s>1&&(p.n=-1),d(s,c)):p.n=c:p.v=c);try{if(u=2,i){if(s||(o="next"),e=i[o]){if(!(e=e.call(i,c)))throw TypeError("iterator result is not an object");if(!e.done)return e;c=e.value,s<2&&(s=0)}else 1===s&&(e=i.return)&&e.call(i),s<2&&(c=TypeError("The iterator does not provide a '"+o+"' method"),s=1);i=t}else if((e=(l=p.n<0)?c:n.call(r,p))!==a)break}catch(e){i=t,s=1,c=e}finally{u=1}}return{value:e,done:l}}}(n,o,i),!0),u}var a={};function s(){}function c(){}function u(){}e=Object.getPrototypeOf;var f=[][r]?e(e([][r]())):(p(e={},r,(function(){return this})),e),d=u.prototype=s.prototype=Object.create(f);function h(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,u):(t.__proto__=u,p(t,o,"GeneratorFunction")),t.prototype=Object.create(d),t}return c.prototype=u,p(d,"constructor",u),p(u,"constructor",c),c.displayName="GeneratorFunction",p(u,o,"GeneratorFunction"),p(d),p(d,o,"Generator"),p(d,r,(function(){return this})),p(d,"toString",(function(){return"[object Generator]"})),(l=function(){return{w:i,m:h}})()}function p(t,e,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}p=function(t,e,n,r){function i(e,n){p(t,e,(function(t){return this._invoke(e,n,t)}))}e?o?o(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n:(i("next",0),i("throw",1),i("return",2))},p(t,e,n,r)}function d(t,e){this.v=t,this.k=e}function h(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return v(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?v(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,o=function(){};return{s:o,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,i=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw i}}}}function v(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function y(t,e,n,r,o,i,a){try{var s=t[i](a),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(r,o)}function b(t){return function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function a(t){y(i,r,o,a,s,"next",t)}function s(t){y(i,r,o,a,s,"throw",t)}a(void 0)}))}}function g(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,m(r.key),r)}}function m(t){var e=function(t){if("object"!=o(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=o(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==o(e)?e:e+""}var w=new(function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.isOn=navigator.onLine,this.setupEvt()},e=[{key:"setupEvt",value:function(){var t=this;window.addEventListener("online",(function(){t.isOn=!0,t.syncPending(),t.showOnMsg()})),window.addEventListener("offline",(function(){t.isOn=!1,t.showOffMsg()}))}},{key:"syncPending",value:(s=b(i().mark((function t(){var e,n,o,a,s;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.isOn){t.next=2;break}return t.abrupt("return");case 2:return t.prev=2,t.next=5,r.U.getPendingSync();case 5:e=t.sent,console.log("Syncing ".concat(e.length," stories...")),n=h(e),t.prev=8,n.s();case 10:if((o=n.n()).done){t.next=31;break}return a=o.value,t.prev=12,(s=new FormData).append("description",a.localData.description),a.localData.photo&&s.append("photo",a.localData.photo),t.next=18,fetch("https://story-api.dicoding.dev/v1/stories",{method:"POST",headers:{Authorization:"Bearer ".concat(a.token)},body:s});case 18:if(!t.sent.ok){t.next=24;break}return t.next=22,r.U.markSynced(a.id);case 22:console.log("Synced: ".concat(a.id)),this.dispatchEvt("storySynced",a);case 24:t.next=29;break;case 26:t.prev=26,t.t0=t.catch(12),console.error("Sync error ".concat(a.id,":"),t.t0);case 29:t.next=10;break;case 31:t.next=36;break;case 33:t.prev=33,t.t1=t.catch(8),n.e(t.t1);case 36:return t.prev=36,n.f(),t.finish(36);case 39:e.length>0&&this.dispatchEvt("syncDone",{count:e.length}),t.next=45;break;case 42:t.prev=42,t.t2=t.catch(2),console.error("Sync error:",t.t2);case 45:case"end":return t.stop()}}),t,this,[[2,42],[8,33,36,39],[12,26]])}))),function(){return s.apply(this,arguments)})},{key:"createOff",value:(a=b(i().mark((function t(e,n){var o,a;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.isOn){t.next=6;break}return t.next=3,this.createOn(e,n);case 3:return t.abrupt("return",t.sent);case 6:return t.next=8,r.U.addOffStory(e,n);case 8:if(o=t.sent,!("serviceWorker"in navigator)||!("SyncManager"in window)){t.next=15;break}return t.next=12,navigator.serviceWorker.ready;case 12:return a=t.sent,t.next=15,a.sync.register("sync-off-stories");case 15:return this.dispatchEvt("storySavedOff",o),t.abrupt("return",o);case 17:case"end":return t.stop()}}),t,this)}))),function(t,e){return a.apply(this,arguments)})},{key:"createOn",value:(o=b(i().mark((function t(e,n){var r,o;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return(r=new FormData).append("description",e.description),e.photo&&r.append("photo",e.photo),t.next=5,fetch("https://story-api.dicoding.dev/v1/stories",{method:"POST",headers:{Authorization:"Bearer ".concat(n)},body:r});case 5:if((o=t.sent).ok){t.next=8;break}throw new Error("Create failed");case 8:return t.next=10,o.json();case 10:return t.abrupt("return",t.sent);case 11:case"end":return t.stop()}}),t)}))),function(t,e){return o.apply(this,arguments)})},{key:"dispatchEvt",value:function(t,e){var n=new CustomEvent(t,{detail:e});window.dispatchEvent(n)}},{key:"showOnMsg",value:function(){"undefined"!=typeof app&&app.showMsg&&app.showMsg("Online!","success")}},{key:"showOffMsg",value:function(){"undefined"!=typeof app&&app.showMsg&&app.showMsg("Offline. Saved local.","warning")}},{key:"getSyncSts",value:(n=b(i().mark((function t(){var e,n;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,r.U.getPendingSync();case 2:return e=t.sent,t.next=5,r.U.getAllFav();case 5:return n=t.sent,t.abrupt("return",{isOnline:this.isOn,pendingSyncCount:e.length,totalFav:n.filter((function(t){return t.isFav})).length,totalStories:n.length});case 7:case"end":return t.stop()}}),t,this)}))),function(){return n.apply(this,arguments)})}],e&&g(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,n,o,a,s}())},825:t=>{t.exports=function(t){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var e=t.insertStyleElement(t);return{update:function(n){!function(t,e,n){var r="";n.supports&&(r+="@supports (".concat(n.supports,") {")),n.media&&(r+="@media ".concat(n.media," {"));var o=void 0!==n.layer;o&&(r+="@layer".concat(n.layer.length>0?" ".concat(n.layer):""," {")),r+=n.css,o&&(r+="}"),n.media&&(r+="}"),n.supports&&(r+="}");var i=n.sourceMap;i&&"undefined"!=typeof btoa&&(r+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(i))))," */")),e.styleTagTransform(r,t,e.options)}(e,t,n)},remove:function(){!function(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t)}(e)}}}}},r={};function o(t){var e=r[t];if(void 0!==e)return e.exports;var i=r[t]={id:t,exports:{}};return n[t](i,i.exports,o),i.exports}o.m=n,o.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return o.d(e,{a:e}),e},o.d=(t,e)=>{for(var n in e)o.o(e,n)&&!o.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},o.f={},o.e=t=>Promise.all(Object.keys(o.f).reduce(((e,n)=>(o.f[n](t,e),e)),[])),o.u=t=>t+".bundle.js",o.miniCssF=t=>{},o.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),o.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),t={},e="app-starter-project-with-webpack:",o.l=(n,r,i,a)=>{if(t[n])t[n].push(r);else{var s,c;if(void 0!==i)for(var u=document.getElementsByTagName("script"),f=0;f<u.length;f++){var l=u[f];if(l.getAttribute("src")==n||l.getAttribute("data-webpack")==e+i){s=l;break}}s||(c=!0,(s=document.createElement("script")).charset="utf-8",s.timeout=120,o.nc&&s.setAttribute("nonce",o.nc),s.setAttribute("data-webpack",e+i),s.src=n),t[n]=[r];var p=(e,r)=>{s.onerror=s.onload=null,clearTimeout(d);var o=t[n];if(delete t[n],s.parentNode&&s.parentNode.removeChild(s),o&&o.forEach((t=>t(r))),e)return e(r)},d=setTimeout(p.bind(null,void 0,{type:"timeout",target:s}),12e4);s.onerror=p.bind(null,s.onerror),s.onload=p.bind(null,s.onload),c&&document.head.appendChild(s)}},o.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},(()=>{var t;o.g.importScripts&&(t=o.g.location+"");var e=o.g.document;if(!t&&e&&(e.currentScript&&"SCRIPT"===e.currentScript.tagName.toUpperCase()&&(t=e.currentScript.src),!t)){var n=e.getElementsByTagName("script");if(n.length)for(var r=n.length-1;r>-1&&(!t||!/^http(s?):/.test(t));)t=n[r--].src}if(!t)throw new Error("Automatic publicPath is not supported in this browser");t=t.replace(/^blob:/,"").replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),o.p=t})(),(()=>{var t={524:0};o.f.j=(e,n)=>{var r=o.o(t,e)?t[e]:void 0;if(0!==r)if(r)n.push(r[2]);else{var i=new Promise(((n,o)=>r=t[e]=[n,o]));n.push(r[2]=i);var a=o.p+o.u(e),s=new Error;o.l(a,(n=>{if(o.o(t,e)&&(0!==(r=t[e])&&(t[e]=void 0),r)){var i=n&&("load"===n.type?"missing":n.type),a=n&&n.target&&n.target.src;s.message="Loading chunk "+e+" failed.\n("+i+": "+a+")",s.name="ChunkLoadError",s.type=i,s.request=a,r[1](s)}}),"chunk-"+e,e)}};var e=(e,n)=>{var r,i,[a,s,c]=n,u=0;if(a.some((e=>0!==t[e]))){for(r in s)o.o(s,r)&&(o.m[r]=s[r]);c&&c(o)}for(e&&e(n);u<a.length;u++)i=a[u],o.o(t,i)&&t[i]&&t[i][0](),t[i]=0},n=self.webpackChunkapp_starter_project_with_webpack=self.webpackChunkapp_starter_project_with_webpack||[];n.forEach(e.bind(null,0)),n.push=e.bind(null,n.push.bind(n))})(),o.nc=void 0;var i=o(72),a=o.n(i),s=o(825),c=o.n(s),u=o(659),f=o.n(u),l=o(56),p=o.n(l),d=o(540),h=o.n(d),v=o(113),y=o.n(v),b=o(177),g={};g.styleTagTransform=y(),g.setAttributes=p(),g.insert=f().bind(null,"head"),g.domAPI=c(),g.insertStyleElement=h(),a()(b.A,g),b.A&&b.A.locals&&b.A.locals;var m=o(775);function w(t){return w="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},w(t)}function k(){var t=N(),e=t.m(k),n=(Object.getPrototypeOf?Object.getPrototypeOf(e):e.__proto__).constructor;function r(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===n||"GeneratorFunction"===(e.displayName||e.name))}var o={throw:1,return:2,break:3,continue:3};function i(t){var e,n;return function(r){e||(e={stop:function(){return n(r.a,2)},catch:function(){return r.v},abrupt:function(t,e){return n(r.a,o[t],e)},delegateYield:function(t,o,i){return e.resultName=o,n(r.d,x(t),i)},finish:function(t){return n(r.f,t)}},n=function(t,n,o){r.p=e.prev,r.n=e.next;try{return t(n,o)}finally{e.next=r.n}}),e.resultName&&(e[e.resultName]=r.v,e.resultName=void 0),e.sent=r.v,e.next=r.n;try{return t.call(this,e)}finally{r.p=e.prev,r.n=e.next}}}return(k=function(){return{wrap:function(e,n,r,o){return t.w(i(e),n,r,o&&o.reverse())},isGeneratorFunction:r,mark:t.m,awrap:function(t,e){return new T(t,e)},AsyncIterator:E,async:function(t,e,n,o,a){return(r(e)?O:P)(i(t),e,n,o,a)},keys:S,values:x}})()}function x(t){if(null!=t){var e=t["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],n=0;if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length))return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}}throw new TypeError(w(t)+" is not iterable")}function S(t){var e=Object(t),n=[];for(var r in e)n.unshift(r);return function t(){for(;n.length;)if((r=n.pop())in e)return t.value=r,t.done=!1,t;return t.done=!0,t}}function P(t,e,n,r,o){var i=O(t,e,n,r,o);return i.next().then((function(t){return t.done?t.value:i.next()}))}function O(t,e,n,r,o){return new E(N().w(t,e,n,r),o||Promise)}function E(t,e){function n(r,o,i,a){try{var s=t[r](o),c=s.value;return c instanceof T?e.resolve(c.v).then((function(t){n("next",t,i,a)}),(function(t){n("throw",t,i,a)})):e.resolve(c).then((function(t){s.value=t,i(s)}),(function(t){return n("throw",t,i,a)}))}catch(t){a(t)}}var r;this.next||(j(E.prototype),j(E.prototype,"function"==typeof Symbol&&Symbol.asyncIterator||"@asyncIterator",(function(){return this}))),j(this,"_invoke",(function(t,o,i){function a(){return new e((function(e,r){n(t,i,e,r)}))}return r=r?r.then(a,a):a()}),!0)}function N(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var c=r&&r.prototype instanceof s?r:s,u=Object.create(c.prototype);return j(u,"_invoke",function(n,r,o){var i,s,c,u=0,f=o||[],l=!1,p={p:0,n:0,v:t,a:d,f:d.bind(t,4),d:function(e,n){return i=e,s=0,c=t,p.n=n,a}};function d(n,r){for(s=n,c=r,e=0;!l&&u&&!o&&e<f.length;e++){var o,i=f[e],d=p.p,h=i[2];n>3?(o=h===r)&&(c=i[(s=i[4])?5:(s=3,3)],i[4]=i[5]=t):i[0]<=d&&((o=n<2&&d<i[1])?(s=0,p.v=r,p.n=i[1]):d<h&&(o=n<3||i[0]>r||r>h)&&(i[4]=n,i[5]=r,p.n=h,s=0))}if(o||n>1)return a;throw l=!0,r}return function(o,f,h){if(u>1)throw TypeError("Generator is already running");for(l&&1===f&&d(f,h),s=f,c=h;(e=s<2?t:c)||!l;){i||(s?s<3?(s>1&&(p.n=-1),d(s,c)):p.n=c:p.v=c);try{if(u=2,i){if(s||(o="next"),e=i[o]){if(!(e=e.call(i,c)))throw TypeError("iterator result is not an object");if(!e.done)return e;c=e.value,s<2&&(s=0)}else 1===s&&(e=i.return)&&e.call(i),s<2&&(c=TypeError("The iterator does not provide a '"+o+"' method"),s=1);i=t}else if((e=(l=p.n<0)?c:n.call(r,p))!==a)break}catch(e){i=t,s=1,c=e}finally{u=1}}return{value:e,done:l}}}(n,o,i),!0),u}var a={};function s(){}function c(){}function u(){}e=Object.getPrototypeOf;var f=[][r]?e(e([][r]())):(j(e={},r,(function(){return this})),e),l=u.prototype=s.prototype=Object.create(f);function p(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,u):(t.__proto__=u,j(t,o,"GeneratorFunction")),t.prototype=Object.create(l),t}return c.prototype=u,j(l,"constructor",u),j(u,"constructor",c),c.displayName="GeneratorFunction",j(u,o,"GeneratorFunction"),j(l),j(l,o,"Generator"),j(l,r,(function(){return this})),j(l,"toString",(function(){return"[object Generator]"})),(N=function(){return{w:i,m:p}})()}function j(t,e,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}j=function(t,e,n,r){function i(e,n){j(t,e,(function(t){return this._invoke(e,n,t)}))}e?o?o(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n:(i("next",0),i("throw",1),i("return",2))},j(t,e,n,r)}function T(t,e){this.v=t,this.k=e}function A(t,e,n,r,o,i,a){try{var s=t[i](a),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(r,o)}function _(t){return function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function a(t){A(i,r,o,a,s,"next",t)}function s(t){A(i,r,o,a,s,"throw",t)}a(void 0)}))}}function I(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,F(r.key),r)}}function F(t){var e=function(t){if("object"!=w(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=w(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==w(e)?e:e+""}const L=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.publicVapidKey="BCCs2eonMI-6H2ctvFaWg-UYdDv387Vno_bzUzALpB442r2lCnsHmtrx8biyPi_E-1fSGABK_Qs_GlvPoJJqxbk",this.swRegistration=null,this.isSubscribed=!1,this.subscription=null},e=[{key:"init",value:(v=_(k().mark((function t(){var e;return k().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.prev=1,t.next=4,o.e(718).then(o.bind(o,718));case 4:(e=t.sent).VAPID_PUBLIC_KEY&&(this.publicVapidKey=e.VAPID_PUBLIC_KEY),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(1),console.log("Using default VAPID key");case 11:if(this.publicVapidKey){t.next=14;break}return console.warn("VAPID public key not found"),t.abrupt("return",!1);case 14:return t.next=16,this._registerServiceWorker();case 16:return this.swRegistration=t.sent,t.next=19,this._checkExistingSubscription();case 19:return t.abrupt("return",!0);case 22:return t.prev=22,t.t1=t.catch(0),console.error("Error initializing push notification:",t.t1),t.abrupt("return",!1);case 26:case"end":return t.stop()}}),t,this,[[0,22],[1,8]])}))),function(){return v.apply(this,arguments)})},{key:"_registerServiceWorker",value:(h=_(k().mark((function t(){var e;return k().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("serviceWorker"in navigator){t.next=2;break}throw new Error("Service workers are not supported");case 2:return t.prev=2,t.next=5,navigator.serviceWorker.register("/sw.js");case 5:return e=t.sent,console.log("Service Worker registered successfully"),t.abrupt("return",e);case 10:throw t.prev=10,t.t0=t.catch(2),console.error("Service Worker registration failed:",t.t0),t.t0;case 14:case"end":return t.stop()}}),t,null,[[2,10]])}))),function(){return h.apply(this,arguments)})},{key:"_checkExistingSubscription",value:(d=_(k().mark((function t(){return k().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.swRegistration.pushManager.getSubscription();case 3:if(this.subscription=t.sent,this.isSubscribed=!(null===this.subscription),console.log("User is subscribed:",this.isSubscribed),!this.isSubscribed){t.next=9;break}return t.next=9,this._sendSubscriptionToServer(this.subscription,"subscribe");case 9:return t.abrupt("return",this.isSubscribed);case 12:return t.prev=12,t.t0=t.catch(0),console.error("Error checking subscription:",t.t0),t.abrupt("return",!1);case 16:case"end":return t.stop()}}),t,this,[[0,12]])}))),function(){return d.apply(this,arguments)})},{key:"subscribe",value:(p=_(k().mark((function t(){var e;return k().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("PushManager"in window){t.next=2;break}throw new Error("Push notifications are not supported");case 2:return t.prev=2,t.next=5,this.requestPermission();case 5:if("granted"===t.sent){t.next=8;break}throw new Error("Notification permission denied");case 8:return t.next=10,this.swRegistration.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:this._urlBase64ToUint8Array(this.publicVapidKey)});case 10:return e=t.sent,this.subscription=e,this.isSubscribed=!0,console.log("Push notification subscribed successfully"),t.next=16,this._sendSubscriptionToServer(e,"subscribe");case 16:return this._updateUI(),t.abrupt("return",!0);case 20:throw t.prev=20,t.t0=t.catch(2),console.error("Failed to subscribe to push notifications:",t.t0),this.isSubscribed=!1,this._updateUI(),t.t0;case 26:case"end":return t.stop()}}),t,this,[[2,20]])}))),function(){return p.apply(this,arguments)})},{key:"unsubscribe",value:(l=_(k().mark((function t(){return k().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,this.subscription){t.next=5;break}return t.next=4,this.swRegistration.pushManager.getSubscription();case 4:this.subscription=t.sent;case 5:if(!this.subscription){t.next=13;break}return t.next=8,this.subscription.unsubscribe();case 8:return t.next=10,this._sendSubscriptionToServer(this.subscription,"unsubscribe");case 10:this.subscription=null,this.isSubscribed=!1,console.log("Unsubscribed from push notifications");case 13:return this._updateUI(),t.abrupt("return",!0);case 17:throw t.prev=17,t.t0=t.catch(0),console.error("Error unsubscribing from push notifications:",t.t0),t.t0;case 21:case"end":return t.stop()}}),t,this,[[0,17]])}))),function(){return l.apply(this,arguments)})},{key:"toggleSubscription",value:(f=_(k().mark((function t(){return k().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,!this.isSubscribed){t.next=7;break}return t.next=4,this.unsubscribe();case 4:return t.abrupt("return",!1);case 7:return t.next=9,this.subscribe();case 9:return t.abrupt("return",!0);case 10:t.next=16;break;case 12:throw t.prev=12,t.t0=t.catch(0),console.error("Error toggling subscription:",t.t0),t.t0;case 16:case"end":return t.stop()}}),t,this,[[0,12]])}))),function(){return f.apply(this,arguments)})},{key:"_sendSubscriptionToServer",value:(u=_(k().mark((function t(e,n){var r,i;return k().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Promise.resolve().then(o.bind(o,775));case 3:return r=t.sent,t.next=6,r.updatePushSubscription(e,n);case 6:return(i=t.sent)&&i.ok?console.log("Subscription ".concat(n," sent to server successfully")):console.error("Failed to send subscription ".concat(n," to server")),t.abrupt("return",i);case 11:return t.prev=11,t.t0=t.catch(0),console.error("Error sending subscription ".concat(n," to server:"),t.t0),t.abrupt("return",null);case 15:case"end":return t.stop()}}),t,null,[[0,11]])}))),function(t,e){return u.apply(this,arguments)})},{key:"sendTestNotification",value:(c=_(k().mark((function t(){var e,n,r,i,a,s=arguments;return k().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=s.length>0&&void 0!==s[0]?s[0]:"Test Notification",n=s.length>1&&void 0!==s[1]?s[1]:"This is a test notification",r=s.length>2&&void 0!==s[2]?s[2]:"/",t.prev=3,t.next=6,Promise.resolve().then(o.bind(o,775));case 6:return i=t.sent,t.next=9,i.sendTestNotification({title:e,body:n,url:r});case 9:return(a=t.sent)&&a.ok?console.log("Test notification sent successfully"):console.error("Failed to send test notification"),t.abrupt("return",a);case 14:return t.prev=14,t.t0=t.catch(3),console.error("Error sending test notification:",t.t0),t.next=19,this._showLocalNotification(e,n,r);case 19:throw t.t0;case 20:case"end":return t.stop()}}),t,this,[[3,14]])}))),function(){return c.apply(this,arguments)})},{key:"_showLocalNotification",value:(s=_(k().mark((function t(e,n,r){return k().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.swRegistration){t.next=3;break}return t.next=3,this.swRegistration.showNotification(e,{body:n,icon:"/images/favicon.png",badge:"/images/favicon.png",data:{url:r},actions:[{action:"open",title:"Buka"},{action:"close",title:"Tutup"}]});case 3:case"end":return t.stop()}}),t,this)}))),function(t,e,n){return s.apply(this,arguments)})},{key:"_urlBase64ToUint8Array",value:function(t){for(var e=(t+"=".repeat((4-t.length%4)%4)).replace(/\-/g,"+").replace(/_/g,"/"),n=window.atob(e),r=new Uint8Array(n.length),o=0;o<n.length;++o)r[o]=n.charCodeAt(o);return r}},{key:"requestPermission",value:(a=_(k().mark((function t(){var e;return k().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("Notification"in window){t.next=3;break}return console.warn("This browser does not support notifications"),t.abrupt("return","denied");case 3:return t.prev=3,t.next=6,Notification.requestPermission();case 6:return e=t.sent,console.log("Notification permission:",e),this._updateUI(),t.abrupt("return",e);case 12:return t.prev=12,t.t0=t.catch(3),console.error("Error requesting notification permission:",t.t0),t.abrupt("return","denied");case 16:case"end":return t.stop()}}),t,this,[[3,12]])}))),function(){return a.apply(this,arguments)})},{key:"_updateUI",value:function(){var t=this.getStatus(),e=new CustomEvent("pushNotificationStatusUpdate",{detail:t});window.dispatchEvent(e)}},{key:"isSupported",value:function(){return"PushManager"in window&&"serviceWorker"in navigator}},{key:"getStatus",value:function(){return{isSupported:this.isSupported(),isSubscribed:this.isSubscribed,permission:Notification.permission,subscription:this.subscription}}},{key:"updateNavigationWithToggle",value:function(){var t=this.getStatus(),e=new CustomEvent("pushNotificationStatusUpdate",{detail:t});window.dispatchEvent(e)}},{key:"getCurrentSubscription",value:(i=_(k().mark((function t(){return k().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.subscription){t.next=4;break}return t.next=3,this.swRegistration.pushManager.getSubscription();case 3:this.subscription=t.sent;case 4:return t.abrupt("return",this.subscription);case 5:case"end":return t.stop()}}),t,this)}))),function(){return i.apply(this,arguments)})},{key:"getPermissionState",value:function(){return Notification.permission}},{key:"isPermissionGranted",value:function(){return"granted"===Notification.permission}},{key:"isPermissionDenied",value:function(){return"denied"===Notification.permission}},{key:"isPermissionDefault",value:function(){return"default"===Notification.permission}},{key:"resetSubscription",value:(r=_(k().mark((function t(){return k().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.unsubscribe();case 3:this.subscription=null,this.isSubscribed=!1,this._updateUI(),console.log("Subscription reset successfully"),t.next=13;break;case 9:throw t.prev=9,t.t0=t.catch(0),console.error("Error resetting subscription:",t.t0),t.t0;case 13:case"end":return t.stop()}}),t,this,[[0,9]])}))),function(){return r.apply(this,arguments)})},{key:"getSubscriptionInfo",value:function(){if(!this.subscription)return null;var t=this.subscription.toJSON();return{endpoint:t.endpoint,keys:t.keys,expirationTime:this.subscription.expirationTime}}},{key:"validateVapidKey",value:function(){if(!this.publicVapidKey)return!1;try{return this._urlBase64ToUint8Array(this.publicVapidKey),!0}catch(t){return console.error("Invalid VAPID key:",t),!1}}},{key:"isServiceWorkerReady",value:(n=_(k().mark((function t(){var e;return k().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.swRegistration){t.next=2;break}return t.abrupt("return",!1);case 2:return t.prev=2,t.next=5,navigator.serviceWorker.ready;case 5:return e=t.sent,t.abrupt("return",e===this.swRegistration);case 9:return t.prev=9,t.t0=t.catch(2),t.abrupt("return",!1);case 12:case"end":return t.stop()}}),t,this,[[2,9]])}))),function(){return n.apply(this,arguments)})},{key:"getServiceWorkerRegistration",value:function(){return this.swRegistration}},{key:"manualTest",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Manual Test",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Manual test notification";this.swRegistration&&this.swRegistration.showNotification(t,{body:e,icon:"/images/favicon.png",badge:"/images/favicon.png",actions:[{action:"open",title:"Open"},{action:"close",title:"Close"}]})}}],e&&I(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,n,r,i,a,s,c,u,f,l,p,d,h,v}();var C=o(330),M=o(805);function D(t){return D="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},D(t)}function G(){var t=W(),e=t.m(G),n=(Object.getPrototypeOf?Object.getPrototypeOf(e):e.__proto__).constructor;function r(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===n||"GeneratorFunction"===(e.displayName||e.name))}var o={throw:1,return:2,break:3,continue:3};function i(t){var e,n;return function(r){e||(e={stop:function(){return n(r.a,2)},catch:function(){return r.v},abrupt:function(t,e){return n(r.a,o[t],e)},delegateYield:function(t,o,i){return e.resultName=o,n(r.d,B(t),i)},finish:function(t){return n(r.f,t)}},n=function(t,n,o){r.p=e.prev,r.n=e.next;try{return t(n,o)}finally{e.next=r.n}}),e.resultName&&(e[e.resultName]=r.v,e.resultName=void 0),e.sent=r.v,e.next=r.n;try{return t.call(this,e)}finally{r.p=e.prev,r.n=e.next}}}return(G=function(){return{wrap:function(e,n,r,o){return t.w(i(e),n,r,o&&o.reverse())},isGeneratorFunction:r,mark:t.m,awrap:function(t,e){return new z(t,e)},AsyncIterator:q,async:function(t,e,n,o,a){return(r(e)?R:V)(i(t),e,n,o,a)},keys:U,values:B}})()}function B(t){if(null!=t){var e=t["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],n=0;if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length))return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}}throw new TypeError(D(t)+" is not iterable")}function U(t){var e=Object(t),n=[];for(var r in e)n.unshift(r);return function t(){for(;n.length;)if((r=n.pop())in e)return t.value=r,t.done=!1,t;return t.done=!0,t}}function V(t,e,n,r,o){var i=R(t,e,n,r,o);return i.next().then((function(t){return t.done?t.value:i.next()}))}function R(t,e,n,r,o){return new q(W().w(t,e,n,r),o||Promise)}function q(t,e){function n(r,o,i,a){try{var s=t[r](o),c=s.value;return c instanceof z?e.resolve(c.v).then((function(t){n("next",t,i,a)}),(function(t){n("throw",t,i,a)})):e.resolve(c).then((function(t){s.value=t,i(s)}),(function(t){return n("throw",t,i,a)}))}catch(t){a(t)}}var r;this.next||(H(q.prototype),H(q.prototype,"function"==typeof Symbol&&Symbol.asyncIterator||"@asyncIterator",(function(){return this}))),H(this,"_invoke",(function(t,o,i){function a(){return new e((function(e,r){n(t,i,e,r)}))}return r=r?r.then(a,a):a()}),!0)}function W(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var c=r&&r.prototype instanceof s?r:s,u=Object.create(c.prototype);return H(u,"_invoke",function(n,r,o){var i,s,c,u=0,f=o||[],l=!1,p={p:0,n:0,v:t,a:d,f:d.bind(t,4),d:function(e,n){return i=e,s=0,c=t,p.n=n,a}};function d(n,r){for(s=n,c=r,e=0;!l&&u&&!o&&e<f.length;e++){var o,i=f[e],d=p.p,h=i[2];n>3?(o=h===r)&&(c=i[(s=i[4])?5:(s=3,3)],i[4]=i[5]=t):i[0]<=d&&((o=n<2&&d<i[1])?(s=0,p.v=r,p.n=i[1]):d<h&&(o=n<3||i[0]>r||r>h)&&(i[4]=n,i[5]=r,p.n=h,s=0))}if(o||n>1)return a;throw l=!0,r}return function(o,f,h){if(u>1)throw TypeError("Generator is already running");for(l&&1===f&&d(f,h),s=f,c=h;(e=s<2?t:c)||!l;){i||(s?s<3?(s>1&&(p.n=-1),d(s,c)):p.n=c:p.v=c);try{if(u=2,i){if(s||(o="next"),e=i[o]){if(!(e=e.call(i,c)))throw TypeError("iterator result is not an object");if(!e.done)return e;c=e.value,s<2&&(s=0)}else 1===s&&(e=i.return)&&e.call(i),s<2&&(c=TypeError("The iterator does not provide a '"+o+"' method"),s=1);i=t}else if((e=(l=p.n<0)?c:n.call(r,p))!==a)break}catch(e){i=t,s=1,c=e}finally{u=1}}return{value:e,done:l}}}(n,o,i),!0),u}var a={};function s(){}function c(){}function u(){}e=Object.getPrototypeOf;var f=[][r]?e(e([][r]())):(H(e={},r,(function(){return this})),e),l=u.prototype=s.prototype=Object.create(f);function p(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,u):(t.__proto__=u,H(t,o,"GeneratorFunction")),t.prototype=Object.create(l),t}return c.prototype=u,H(l,"constructor",u),H(u,"constructor",c),c.displayName="GeneratorFunction",H(u,o,"GeneratorFunction"),H(l),H(l,o,"Generator"),H(l,r,(function(){return this})),H(l,"toString",(function(){return"[object Generator]"})),(W=function(){return{w:i,m:p}})()}function H(t,e,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}H=function(t,e,n,r){function i(e,n){H(t,e,(function(t){return this._invoke(e,n,t)}))}e?o?o(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n:(i("next",0),i("throw",1),i("return",2))},H(t,e,n,r)}function z(t,e){this.v=t,this.k=e}function J(t,e,n,r,o,i,a){try{var s=t[i](a),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(r,o)}function K(t){return function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function a(t){J(i,r,o,a,s,"next",t)}function s(t){J(i,r,o,a,s,"throw",t)}a(void 0)}))}}function Y(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,$(r.key),r)}}function $(t){var e=function(t){if("object"!=D(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=D(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==D(e)?e:e+""}var Q=new(function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.currentPage=null,this.pushNotification=new L,this.init()},e=[{key:"init",value:function(){var t=this;"loading"===document.readyState?document.addEventListener("DOMContentLoaded",(function(){t.setupRouter(),t.loadInitialView(),t.updateNavigation(),t.initializePushNotifications(),t.setupPushNotificationEvents(),t.setupPWAInstallation()})):(this.setupRouter(),this.loadInitialView(),this.updateNavigation(),this.initializePushNotifications(),this.setupPushNotificationEvents(),this.setupPWAInstallation())}},{key:"setupPushNotificationEvents",value:function(){var t=this;window.addEventListener("pushNotificationStatusUpdate",(function(e){t.handlePushNotificationStatusUpdate(e.detail)})),window.addEventListener("notificationPermissionChanged",(function(e){t.handleNotificationPermissionChanged(e.detail)})),"serviceWorker"in navigator&&navigator.serviceWorker.addEventListener("message",(function(e){e.data&&"NAVIGATE_TO_URL"===e.data.type&&t.handleNotificationNavigation(e.data.url)}))}},{key:"setupPWAInstallation",value:function(){console.log("PWA installation setup completed")}},{key:"showOnlineMessage",value:function(){"undefined"!=typeof Swal&&Swal.fire({icon:"success",title:"Koneksi Pulih",text:"Anda kembali online",timer:2e3,showConfirmButton:!1,position:"top-end"})}},{key:"showOfflineMessage",value:function(){console.log("App is offline")}},{key:"preloadStoriesForOffline",value:(E=K(G().mark((function t(){var e,n;return G().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,fetch("https://story-api.dicoding.dev/v1/stories");case 3:if(!(e=t.sent).ok){t.next=11;break}return t.next=7,e.json();case 7:n=t.sent,localStorage.setItem("offlineStories",JSON.stringify(n.listStory||[])),localStorage.setItem("storiesLastUpdated",(new Date).toISOString()),console.log("Stories preloaded for offline use");case 11:t.next=16;break;case 13:t.prev=13,t.t0=t.catch(0),console.log("Preload stories failed:",t.t0);case 16:case"end":return t.stop()}}),t,null,[[0,13]])}))),function(){return E.apply(this,arguments)})},{key:"getOfflineStories",value:function(){try{var t=localStorage.getItem("offlineStories");return t?JSON.parse(t):[]}catch(t){return[]}}},{key:"isPWAInstalled",value:function(){return window.matchMedia("(display-mode: standalone)").matches||!0===window.navigator.standalone}},{key:"installPWA",value:(O=K(G().mark((function t(){var e,n;return G().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!window.deferredPrompt){t.next=9;break}return window.deferredPrompt.prompt(),t.next=4,window.deferredPrompt.userChoice;case 4:return e=t.sent,n=e.outcome,console.log("User response: ".concat(n)),window.deferredPrompt=null,t.abrupt("return","accepted"===n);case 9:return t.abrupt("return",!1);case 10:case"end":return t.stop()}}),t)}))),function(){return O.apply(this,arguments)})},{key:"handleNotificationNavigation",value:function(t){console.log("Navigating from notification to:",t);var e=t.includes("#")?t.split("#")[1]:"/home";window.location.hash=e}},{key:"handlePushNotificationStatusUpdate",value:function(t){console.log("Push notification status updated:",t),this.updateNavigation()}},{key:"handleNotificationPermissionChanged",value:function(t){console.log("Notification permission changed:",t),this.updateNavigation()}},{key:"initializePushNotifications",value:(P=K(G().mark((function t(){return G().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.pushNotification.isSupported()){t.next=3;break}return console.warn("Push notifications are not supported in this browser"),t.abrupt("return");case 3:return t.prev=3,t.next=6,this.pushNotification.init();case 6:t.sent?(console.log("Push notifications initialized successfully"),this.pushNotification.updateNavigationWithToggle(),this.setupPushNotificationTest()):console.warn("Push notifications initialization failed"),t.next=13;break;case 10:t.prev=10,t.t0=t.catch(3),console.error("Error initializing push notifications:",t.t0);case 13:case"end":return t.stop()}}),t,this,[[3,10]])}))),function(){return P.apply(this,arguments)})},{key:"togglePushNotifications",value:(S=K(G().mark((function t(){var e;return G().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.pushNotification.toggleSubscription();case 3:return e=t.sent,"undefined"!=typeof Swal&&Swal.fire({icon:"success",title:e?"Notifikasi Diaktifkan":"Notifikasi Dinonaktifkan",text:e?"Anda akan menerima notifikasi dari StoryHive":"Anda tidak akan menerima notifikasi lagi",confirmButtonColor:"#2563eb"}),t.abrupt("return",e);case 8:throw t.prev=8,t.t0=t.catch(0),console.error("Error toggling push notifications:",t.t0),"undefined"!=typeof Swal&&Swal.fire({icon:"error",title:"Gagal Mengubah Pengaturan",text:t.t0.message||"Terjadi kesalahan saat mengubah pengaturan notifikasi",confirmButtonColor:"#dc2626"}),t.t0;case 13:case"end":return t.stop()}}),t,this,[[0,8]])}))),function(){return S.apply(this,arguments)})},{key:"testPushNotification",value:(x=K(G().mark((function t(){return G().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.pushNotification.sendTestNotification("Test Notifikasi StoryHive","Ini adalah notifikasi test dari StoryHive. Notifikasi berhasil dikonfigurasi!","#/home");case 3:"undefined"!=typeof Swal&&Swal.fire({icon:"success",title:"Test Notifikasi Dikirim",text:"Cek notifikasi yang muncul di perangkat Anda",confirmButtonColor:"#2563eb"}),t.next=10;break;case 6:t.prev=6,t.t0=t.catch(0),console.error("Error testing push notification:",t.t0),"undefined"!=typeof Swal&&Swal.fire({icon:"error",title:"Test Gagal",text:"Gagal mengirim test notifikasi",confirmButtonColor:"#dc2626"});case 10:case"end":return t.stop()}}),t,this,[[0,6]])}))),function(){return x.apply(this,arguments)})},{key:"setupPushNotificationTest",value:function(){var t=this;window.testPushNotification=function(){return t.testPushNotification()},window.togglePushNotifications=function(){return t.togglePushNotifications()},window.getPushStatus=function(){return t.pushNotification.getStatus()},console.log("=== Push Notification Debug ==="),console.log("1. testPushNotification() - Test notifikasi (console only)"),console.log("2. togglePushNotifications() - Toggle subscription"),console.log("3. getPushStatus() - Lihat status"),console.log("4. Chrome DevTools  Application  Service Workers  Push"),console.log("==============================")}},{key:"setupRouter",value:function(){var t=this;window.addEventListener("hashchange",(function(){t.handleRouteChange(),t.updateNavigation()}))}},{key:"handleRouteChange",value:(k=K(G().mark((function t(){var e;return G().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=window.location.hash.slice(1)||"/home",t.next=3,this.loadView(e);case 3:case"end":return t.stop()}}),t,this)}))),function(){return k.apply(this,arguments)})},{key:"loadInitialView",value:(w=K(G().mark((function t(){var e;return G().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=window.location.hash.slice(1)||"/home",t.next=3,this.loadView(e);case 3:case"end":return t.stop()}}),t,this)}))),function(){return w.apply(this,arguments)})},{key:"loadView",value:(g=K(G().mark((function t(e){var n;return G().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e.replace(/\/$/,""),!this.currentPage){t.next=4;break}return t.next=4,this.transitionOut(this.currentPage);case 4:if(m.default.isLoggedIn()||"/add-s"!==n&&!n.startsWith("/s/")){t.next=7;break}return window.location.hash="#/auth",t.abrupt("return");case 7:if(!m.default.isLoggedIn()||"/auth"!==n&&"/register"!==n){t.next=10;break}return window.location.hash="#/home",t.abrupt("return");case 10:if(t.prev=10,!n.startsWith("/s/")){t.next=16;break}return t.next=14,this.loadStoryDetailView(n);case 14:t.next=37;break;case 16:t.t0=n,t.next="/home"===t.t0?19:"/add-s"===t.t0?22:"/auth"===t.t0?25:"/register"===t.t0?28:"/fav"===t.t0?31:34;break;case 19:return t.next=21,this.loadHomeView();case 21:case 24:case 27:case 30:case 33:case 36:return t.abrupt("break",37);case 22:return t.next=24,this.loadAddStoryView();case 25:return t.next=27,this.loadLoginView();case 28:return t.next=30,this.loadRegisterView();case 31:return t.next=33,this.loadFavView();case 34:return t.next=36,this.loadHomeView();case 37:t.next=43;break;case 39:return t.prev=39,t.t1=t.catch(10),t.next=43,this.showErrorView("Gagal memuat halaman: "+t.t1.message);case 43:case"end":return t.stop()}}),t,this,[[10,39]])}))),function(t){return g.apply(this,arguments)})},{key:"transitionOut",value:(b=K(G().mark((function t(e){return G().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(e&&e.element&&e.element instanceof Node)){t.next=6;break}return e.element.classList.remove("is-active"),e.element.classList.add("is-fading"),t.next=5,new Promise((function(t){return setTimeout(t,300)}));case 5:"function"==typeof e.destroy&&e.destroy();case 6:case"end":return t.stop()}}),t)}))),function(t){return b.apply(this,arguments)})},{key:"transitionIn",value:(y=K(G().mark((function t(e){return G().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(e&&e.element&&e.element instanceof Node)){t.next=5;break}return e.element.classList.remove("is-fading"),e.element.classList.add("is-active"),t.next=5,new Promise((function(t){return setTimeout(t,50)}));case 5:case"end":return t.stop()}}),t)}))),function(t){return y.apply(this,arguments)})},{key:"loadHomeView",value:(v=K(G().mark((function t(){var e,n,r;return G().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,o.e(742).then(o.bind(o,742));case 3:if(e=t.sent,n=e.HomePg,(r=new n).element&&r.element instanceof Node){t.next=8;break}throw new Error("HomePg element is not valid");case 8:return this.currentPage=r,t.next=11,this.showPage(r);case 11:return t.next=13,r.init();case 13:t.next=18;break;case 15:throw t.prev=15,t.t0=t.catch(0),t.t0;case 18:case"end":return t.stop()}}),t,this,[[0,15]])}))),function(){return v.apply(this,arguments)})},{key:"loadAddStoryView",value:(h=K(G().mark((function t(){var e,n,r;return G().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,o.e(350).then(o.bind(o,350));case 3:if(e=t.sent,n=e.AddSPg,(r=new n).element&&r.element instanceof Node){t.next=8;break}throw new Error("AddSPg element is not valid");case 8:return this.currentPage=r,t.next=11,this.showPage(r);case 11:return t.next=13,r.init();case 13:t.next=18;break;case 15:throw t.prev=15,t.t0=t.catch(0),t.t0;case 18:case"end":return t.stop()}}),t,this,[[0,15]])}))),function(){return h.apply(this,arguments)})},{key:"loadStoryDetailView",value:(d=K(G().mark((function t(e){var n,r,i;return G().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,o.e(502).then(o.bind(o,502));case 3:if(n=t.sent,r=n.SDetailPg,(i=new r).element&&i.element instanceof Node){t.next=8;break}throw new Error("SDetailPg element is not valid");case 8:return this.currentPage=i,t.next=11,this.showPage(i);case 11:return t.next=13,i.init(e);case 13:t.next=18;break;case 15:throw t.prev=15,t.t0=t.catch(0),t.t0;case 18:case"end":return t.stop()}}),t,this,[[0,15]])}))),function(t){return d.apply(this,arguments)})},{key:"loadLoginView",value:(p=K(G().mark((function t(){var e,n,r;return G().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,o.e(323).then(o.bind(o,323));case 3:if(e=t.sent,n=e.LoginPg,(r=new n).element&&r.element instanceof Node){t.next=8;break}throw new Error("LoginPg element is not valid");case 8:return this.currentPage=r,t.next=11,this.showPage(r);case 11:return t.next=13,r.init();case 13:t.next=18;break;case 15:throw t.prev=15,t.t0=t.catch(0),t.t0;case 18:case"end":return t.stop()}}),t,this,[[0,15]])}))),function(){return p.apply(this,arguments)})},{key:"loadRegisterView",value:(l=K(G().mark((function t(){var e,n,r;return G().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,o.e(10).then(o.bind(o,10));case 3:if(e=t.sent,n=e.RegPg,(r=new n).element&&r.element instanceof Node){t.next=8;break}throw new Error("RegPg element is not valid");case 8:return this.currentPage=r,t.next=11,this.showPage(r);case 11:return t.next=13,r.init();case 13:t.next=18;break;case 15:throw t.prev=15,t.t0=t.catch(0),t.t0;case 18:case"end":return t.stop()}}),t,this,[[0,15]])}))),function(){return l.apply(this,arguments)})},{key:"loadFavView",value:(f=K(G().mark((function t(){var e,n,r;return G().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,o.e(454).then(o.bind(o,454));case 3:if(e=t.sent,n=e.default,r=new n,console.log("FavPage created, element:",r.element),r.element||"function"!=typeof r.init){t.next=12;break}return console.log("Calling FavPage.init()..."),t.next=11,r.init();case 11:console.log("After init, element:",r.element);case 12:if(r.element||"function"!=typeof r.createView||(console.log("Calling FavPage.createView()..."),r.createView(),console.log("After createView, element:",r.element)),r.element&&r.element instanceof Node){t.next=16;break}throw console.error("FavPage element is invalid:",r.element),new Error("FavPage element is not valid. Type: "+D(r.element));case 16:return console.log("FavPage element is valid, showing page..."),this.currentPage=r,t.next=20,this.showPage(r);case 20:if("function"!=typeof r.afterRender){t.next=23;break}return t.next=23,r.afterRender();case 23:t.next=29;break;case 25:throw t.prev=25,t.t0=t.catch(0),console.error("Error loading fav view:",t.t0),t.t0;case 29:case"end":return t.stop()}}),t,this,[[0,25]])}))),function(){return f.apply(this,arguments)})},{key:"showPage",value:(u=K(G().mark((function t(e){var n,r,o=this;return G().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,(n=document.getElementById("view-cntnr"))||(n=document.getElementById("main")),n||(n=document.getElementById("app")),n||(n=document.body),n){t.next=7;break}throw new Error("No container element found in DOM");case 7:if(e&&e.element&&e.element instanceof Node){t.next=9;break}throw new Error("Page element is not valid");case 9:if(!document.startViewTransition){t.next=14;break}return t.next=12,document.startViewTransition(K(G().mark((function t(){return G().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n.innerHTML="",n.appendChild(e.element),t.next=4,o.transitionIn(e);case 4:case"end":return t.stop()}}),t)})))).ready;case 12:t.next=18;break;case 14:return n.innerHTML="",n.appendChild(e.element),t.next=18,this.transitionIn(e);case 18:(r=document.getElementById("main"))&&r.focus(),t.next=25;break;case 22:throw t.prev=22,t.t0=t.catch(0),t.t0;case 25:case"end":return t.stop()}}),t,this,[[0,22]])}))),function(t){return u.apply(this,arguments)})},{key:"showErrorView",value:(c=K(G().mark((function t(e){var n,r;return G().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:(n=document.getElementById("view-cntnr"))||(n=document.getElementById("main")),n||(n=document.getElementById("app")),n||(n=document.body),n?n.innerHTML='\n                <div class="error-cntnr" style="padding: 2rem; text-align: center;">\n                    <h2>Terjadi Kesalahan</h2>\n                    <p>'.concat(e,'</p>\n                    <button onclick="window.location.hash = \'#/home\'" class="btn-primary">\n                        Kembali ke Home\n                    </button>\n                </div>\n            '):((r=document.createElement("div")).innerHTML='\n                <div style="padding: 2rem; text-align: center;">\n                    <h2>Terjadi Kesalahan</h2>\n                    <p>'.concat(e,'</p>\n                    <button onclick="location.reload()" style="padding: 10px 20px; background: #2563eb; color: white; border: none; border-radius: 5px; cursor: pointer;">\n                        Refresh Halaman\n                    </button>\n                </div>\n            '),document.body.appendChild(r));case 5:case"end":return t.stop()}}),t)}))),function(t){return c.apply(this,arguments)})},{key:"addToFav",value:(s=K(G().mark((function t(e){return G().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,C.U.addFav(e);case 3:this.showMsg("Cerita ditambahkan ke fav!","success"),t.next=10;break;case 6:t.prev=6,t.t0=t.catch(0),console.error("Error adding to fav:",t.t0),this.showMsg("Gagal menambahkan ke fav","error");case 10:case"end":return t.stop()}}),t,this,[[0,6]])}))),function(t){return s.apply(this,arguments)})},{key:"createStoryWithOfflineSupport",value:(a=K(G().mark((function t(e,n){return G().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,M.J.createOff(e,n);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)}))),function(t,e){return a.apply(this,arguments)})},{key:"isStoryFav",value:(i=K(G().mark((function t(e){return G().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,C.U.isFav(e);case 3:return t.abrupt("return",t.sent);case 6:return t.prev=6,t.t0=t.catch(0),console.error("Error checking fav status:",t.t0),t.abrupt("return",!1);case 10:case"end":return t.stop()}}),t,null,[[0,6]])}))),function(t){return i.apply(this,arguments)})},{key:"removeFromFav",value:(r=K(G().mark((function t(e){return G().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,C.U.rmvFav(e);case 3:this.showMsg("Cerita dihapus dari fav","success"),t.next=10;break;case 6:t.prev=6,t.t0=t.catch(0),console.error("Error removing from fav:",t.t0),this.showMsg("Gagal menghapus dari fav","error");case 10:case"end":return t.stop()}}),t,this,[[0,6]])}))),function(t){return r.apply(this,arguments)})},{key:"getSyncStatus",value:(n=K(G().mark((function t(){return G().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,M.J.getSyncSts();case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)}))),function(){return n.apply(this,arguments)})},{key:"showMsg",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"info";"undefined"!=typeof Swal?Swal.mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,didOpen:function(t){t.addEventListener("mouseenter",Swal.stopTimer),t.addEventListener("mouseleave",Swal.resumeTimer)}}).fire({icon:e,title:t}):console.log("".concat(e,": ").concat(t))}},{key:"updateNavigation",value:function(){var t=document.querySelector(".nav");if(!t){var e=document.querySelector(".hdr");if(!e)return;(t=document.createElement("nav")).className="nav",e.appendChild(t)}var n=m.default.getUser(),r=m.default.isLoggedIn(),o=this.pushNotification.getStatus(),i="";if(r&&o.isSupported){var a=o.isSubscribed;"granted"===o.permission?i='\n                    <li class="notification-toggle-item">\n                        <button class="notification-toggle '.concat(a?"is-active":"",'" \n                                onclick="app.togglePushNotifications()"\n                                title="').concat(a?"Nonaktifkan":"Aktifkan",' notifikasi">\n                            <span class="toggle-icon"></span>\n                            <span class="toggle-text">').concat(a?"Notifikasi Aktif":"Notifikasi Nonaktif","</span>\n                        </button>\n                    </li>\n                "):"default"===o.permission&&(i='\n                    <li class="notification-toggle-item">\n                        <button class="notification-toggle enable-permission" \n                                onclick="app.pushNotification.requestPermission()"\n                                title="Aktifkan notifikasi">\n                            <span class="toggle-icon"></span>\n                            <span class="toggle-text">Aktifkan Notifikasi</span>\n                        </button>\n                    </li>\n                ')}var s="";r&&(s='<li><a href="#/fav">  Cerita Favorit</a></li>');var c;c=r&&n?'\n                <li><a href="#/add-s"> Tambah Cerita</a></li>\n                '.concat(s,"\n                ").concat(i,'\n                <li class="usr-dd">\n                    <button class="usr-dd-toggle" aria-expanded="false">\n                        <span class="usr-greet">').concat(n.name,'</span>\n                    </button>\n                    <div class="usr-dd-menu">\n                        <button class="usr-dd-item logout" onclick="app.handleLogout()">\n                             Logout\n                        </button>\n                    </div>\n                </li>\n            '):'\n                <div class="auth-links">\n                    <a href="#/auth" class="auth-link login">Login</a>\n                    <a href="#/register" class="auth-link register">Daftar</a>\n                </div>\n            ',t.innerHTML='\n            <div class="nav-brand">\n                <a href="#/home" class="nav-brand">\n                    <img src="/images/Logo.png" alt="StoryHive Logo" class="nav-brand-img">\n                </a>\n            </div>\n            \n            <button class="nav-toggle" aria-label="Toggle menu" aria-expanded="false">\n                <span></span>\n                <span></span>\n                <span></span>\n            </button>\n    \n            <ul class="nav-menu">\n                <li><a href="#/home"> Home</a></li>\n                '.concat(c,"\n            </ul>\n        "),this.setupMobileNavigation(),this.setupDropdowns()}},{key:"setupMobileNavigation",value:function(){var t=this,e=document.querySelector(".nav-toggle"),n=document.querySelector(".nav-menu");if(e&&n){var r=document.querySelector(".overlay");r||((r=document.createElement("div")).className="overlay",document.body.appendChild(r)),e.addEventListener("click",(function(t){t.stopPropagation();var o="true"===e.getAttribute("aria-expanded");e.classList.toggle("is-active"),e.setAttribute("aria-expanded",!o),n.classList.toggle("is-active"),r.classList.toggle("is-active"),document.body.style.overflow=n.classList.contains("is-active")?"hidden":""})),r.addEventListener("click",(function(){t.closeMobileMenu()})),n.addEventListener("click",(function(e){("A"===e.target.tagName||e.target.classList.contains("usr-dd-item"))&&t.closeMobileMenu()})),document.addEventListener("keydown",(function(e){"Escape"===e.key&&t.closeMobileMenu()})),window.addEventListener("resize",(function(){window.innerWidth>768&&t.closeMobileMenu()}))}}},{key:"setupDropdowns",value:function(){document.querySelectorAll(".usr-dd-toggle").forEach((function(t){t.addEventListener("click",(function(e){e.stopPropagation();var n=t.nextElementSibling,r="true"===t.getAttribute("aria-expanded");document.querySelectorAll(".usr-dd-menu").forEach((function(t){t!==n&&t.classList.remove("is-active")})),document.querySelectorAll(".usr-dd-toggle").forEach((function(e){e!==t&&(e.setAttribute("aria-expanded","false"),e.classList.remove("is-active"))})),t.setAttribute("aria-expanded",!r),t.classList.toggle("is-active"),n.classList.toggle("is-active")}))})),document.addEventListener("click",(function(){document.querySelectorAll(".usr-dd-menu").forEach((function(t){t.classList.remove("is-active")})),document.querySelectorAll(".usr-dd-toggle").forEach((function(t){t.setAttribute("aria-expanded","false"),t.classList.remove("is-active")}))})),document.querySelectorAll(".usr-dd-menu").forEach((function(t){t.addEventListener("click",(function(t){t.stopPropagation()}))}))}},{key:"closeMobileMenu",value:function(){var t=document.querySelector(".nav-toggle"),e=document.querySelector(".nav-menu"),n=document.querySelector(".overlay");t&&t.classList.remove("is-active"),t&&t.setAttribute("aria-expanded","false"),e&&e.classList.remove("is-active"),n&&n.classList.remove("is-active"),document.body.style.overflow=""}},{key:"handleLogout",value:function(){var t=this;"undefined"!=typeof Swal?Swal.fire({title:"Logout",text:"Apakah Anda yakin ingin logout?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#dc2626",cancelButtonColor:"#64748b",confirmButtonText:"Ya, Logout",cancelButtonText:"Batal"}).then((function(e){e.isConfirmed&&(t.pushNotification.unsubscribe().catch(console.error),m.default.logout(),t.updateNavigation(),window.location.hash="#/home",Swal.fire({icon:"success",title:"Logout Berhasil",text:"Anda telah berhasil logout.",confirmButtonColor:"#2563eb"}))})):confirm("Apakah Anda yakin ingin logout?")&&(this.pushNotification.unsubscribe().catch(console.error),m.default.logout(),this.updateNavigation(),window.location.hash="#/home")}}],e&&Y(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,n,r,i,a,s,c,u,f,l,p,d,h,v,y,b,g,w,k,x,S,P,O,E}());window.app=Q,window.addToFav=function(t){return Q.addToFav(t)},window.isStoryFav=function(t){return Q.isStoryFav(t)},window.removeFromFav=function(t){return Q.removeFromFav(t)},window.createStoryOffline=function(t,e){return Q.createStoryWithOfflineSupport(t,e)},window.getSyncStatus=function(){return Q.getSyncStatus()}})();